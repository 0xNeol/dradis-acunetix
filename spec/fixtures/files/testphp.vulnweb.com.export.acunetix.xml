<?xml version="1.0"?>
<ScanGroup ExportedOn="23/10/2014, 11:44">
  <Scan>
    <Name><![CDATA[Scan Thread 1 ( http://testphp.vulnweb.com:80/ )]]></Name>
    <ShortName><![CDATA[Scan Thread 1]]></ShortName>
    <StartURL><![CDATA[http://testphp.vulnweb.com:80/]]></StartURL>
    <StartTime><![CDATA[7/10/2014, 11:56:03]]></StartTime>
    <FinishTime><![CDATA[7/10/2014, 15:20:55]]></FinishTime>
    <ScanTime><![CDATA[3 hours, 24 minutes]]></ScanTime>
    <Aborted><![CDATA[False]]></Aborted>
    <Responsive><![CDATA[True]]></Responsive>
    <Banner><![CDATA[nginx/1.4.1]]></Banner>
    <Os><![CDATA[Unknown]]></Os>
    <WebServer><![CDATA[nginx]]></WebServer>
    <Technologies><![CDATA[PHP]]></Technologies>
    <Crawler StartUrl="http://testphp.vulnweb.com/">
      <LoginSequence>
   </LoginSequence>
      <Cookies>
        <Variable Name="login" Type="Cookie">
     </Variable>
        <Variable Name="mycookie" Type="Cookie">
     </Variable>
      </Cookies>
      <SiteFiles>
        <SiteFile id="1">
          <Name/>
          <URL>/</URL>
          <FullURL>http://testphp.vulnweb.com/</FullURL>
          <Inputs>
            <Variable Name="Host" Type="HTTP Header">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="2">
          <Name>search.php</Name>
          <URL>/search.php</URL>
          <FullURL>http://testphp.vulnweb.com/search.php</FullURL>
          <Inputs>
            <Variable Name="test" Type="URL encoded GET">
       </Variable>
            <Variable Name="goButton" Type="URL encoded POST">
       </Variable>
            <Variable Name="goButton" Type="URL encoded POST">
       </Variable>
            <Variable Name="test" Type="URL encoded GET">
       </Variable>
            <Variable Name="searchFor" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/search.php?test=query</URL>
              <PostData><![CDATA[goButton=go&amp;searchFor=]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/search.php?test=query</URL>
              <PostData><![CDATA[goButton=go&amp;searchFor=the]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="3">
          <Name>hpp</Name>
          <URL>/hpp/</URL>
          <FullURL>http://testphp.vulnweb.com/hpp/</FullURL>
          <Inputs>
            <Variable Name="pp" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/hpp/?pp=12</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="4">
          <Name>params.php</Name>
          <URL>/hpp/params.php</URL>
          <FullURL>http://testphp.vulnweb.com/hpp/params.php</FullURL>
          <Inputs>
            <Variable Name="p" Type="URL encoded GET">
       </Variable>
            <Variable Name="p" Type="URL encoded GET">
       </Variable>
            <Variable Name="aaaa/" Type="URL encoded GET">
       </Variable>
            <Variable Name="aaaa/" Type="URL encoded GET">
       </Variable>
            <Variable Name="aaaa/" Type="URL encoded GET">
       </Variable>
            <Variable Name="aaaa/" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/hpp/params.php?aaaa/=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/hpp/params.php?p=valid&amp;pp=12</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="5">
          <Name>index.php</Name>
          <URL>/hpp/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/hpp/index.php</FullURL>
          <Inputs>
            <Variable Name="pp" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/hpp/index.php?pp=12</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="6">
          <Name>test.php</Name>
          <URL>/hpp/test.php</URL>
          <FullURL>http://testphp.vulnweb.com/hpp/test.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="7">
          <Name>cart.php</Name>
          <URL>/cart.php</URL>
          <FullURL>http://testphp.vulnweb.com/cart.php</FullURL>
          <Inputs>
            <Variable Name="addcart" Type="URL encoded POST">
       </Variable>
            <Variable Name="addcart" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/cart.php</URL>
              <PostData><![CDATA[addcart=3&amp;price=986]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/cart.php</URL>
              <PostData><![CDATA[addcart=2&amp;price=800]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/cart.php</URL>
              <PostData><![CDATA[addcart=4&amp;price=1000]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="8">
          <Name>index.php</Name>
          <URL>/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/index.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="9">
          <Name>login.php</Name>
          <URL>/login.php</URL>
          <FullURL>http://testphp.vulnweb.com/login.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="10">
          <Name>style.css</Name>
          <URL>/style.css</URL>
          <FullURL>http://testphp.vulnweb.com/style.css</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="11">
          <Name>artists.php</Name>
          <URL>/artists.php</URL>
          <FullURL>http://testphp.vulnweb.com/artists.php</FullURL>
          <Inputs>
            <Variable Name="artist" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/artists.php?artist=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/artists.php?artist=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/artists.php?artist=3</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="12">
          <Name>privacy.php</Name>
          <URL>/privacy.php</URL>
          <FullURL>http://testphp.vulnweb.com/privacy.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="13">
          <Name>userinfo.php</Name>
          <URL>/userinfo.php</URL>
          <FullURL>http://testphp.vulnweb.com/userinfo.php</FullURL>
          <Inputs>
            <Variable Name="pass" Type="URL encoded POST">
       </Variable>
            <Variable Name="pass" Type="URL encoded POST">
       </Variable>
            <Variable Name="uname" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/userinfo.php</URL>
              <PostData><![CDATA[pass=g00dPa%24%24w0rD&amp;uname=xgwkrkop]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="14">
          <Name>guestbook.php</Name>
          <URL>/guestbook.php</URL>
          <FullURL>http://testphp.vulnweb.com/guestbook.php</FullURL>
          <Inputs>
            <Variable Name="name" Type="URL encoded POST">
       </Variable>
            <Variable Name="name" Type="URL encoded POST">
       </Variable>
            <Variable Name="name" Type="URL encoded POST">
       </Variable>
            <Variable Name="name" Type="URL encoded POST">
       </Variable>
            <Variable Name="name" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/guestbook.php</URL>
              <PostData><![CDATA[name=anonymous%20user&amp;submit=add%20message&amp;text=1]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="15">
          <Name>categories.php</Name>
          <URL>/categories.php</URL>
          <FullURL>http://testphp.vulnweb.com/categories.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="16">
          <Name>Flash</Name>
          <URL>/Flash/</URL>
          <FullURL>http://testphp.vulnweb.com/Flash/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="17">
          <Name>add.swf</Name>
          <URL>/Flash/add.swf</URL>
          <FullURL>http://testphp.vulnweb.com/Flash/add.swf</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="18">
          <Name>add.fla</Name>
          <URL>/Flash/add.fla</URL>
          <FullURL>http://testphp.vulnweb.com/Flash/add.fla</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="19">
          <Name>AJAX</Name>
          <URL>/AJAX/</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="20">
          <Name>index.php</Name>
          <URL>/AJAX/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/index.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="21">
          <Name>infotitle.php</Name>
          <URL>/AJAX/infotitle.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/infotitle.php</FullURL>
          <Inputs>
            <Variable Name="id" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infotitle.php</URL>
              <PostData><![CDATA[id=1]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infotitle.php</URL>
              <PostData><![CDATA[id=2]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infotitle.php</URL>
              <PostData><![CDATA[id=3]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="22">
          <Name>artists.php</Name>
          <URL>/AJAX/artists.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/artists.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="23">
          <Name>infoartist.php</Name>
          <URL>/AJAX/infoartist.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/infoartist.php</FullURL>
          <Inputs>
            <Variable Name="id" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infoartist.php?id=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infoartist.php?id=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infoartist.php?id=3</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="24">
          <Name>titles.php</Name>
          <URL>/AJAX/titles.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/titles.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="25">
          <Name>showxml.php</Name>
          <URL>/AJAX/showxml.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/showxml.php</FullURL>
          <Inputs>
            <Variable Name="text/xml" Type="Custom POST">
       </Variable>
            <Variable Name="xml.node:name" Type="XML">
       </Variable>
            <Variable Name="xml.node:name" Type="XML">
       </Variable>
            <Variable Name="xml.node:name" Type="XML">
       </Variable>
            <Variable Name="xml.node:name" Type="XML">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/showxml.php</URL>
              <PostData><![CDATA[&lt;xml&gt;&lt;node name=&quot;nodename1&quot;&gt;nodetext1&lt;/node&gt;&lt;node name=&quot;nodename2&quot;&gt;nodetext2&lt;/node&gt;&lt;/xml&gt;]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="26">
          <Name>styles.css</Name>
          <URL>/AJAX/styles.css</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/styles.css</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="27">
          <Name>infocateg.php</Name>
          <URL>/AJAX/infocateg.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/infocateg.php</FullURL>
          <Inputs>
            <Variable Name="id" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infocateg.php?id=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infocateg.php?id=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/AJAX/infocateg.php?id=3</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="28">
          <Name>categories.php</Name>
          <URL>/AJAX/categories.php</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/categories.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="29">
          <Name>htaccess.conf</Name>
          <URL>/AJAX/htaccess.conf</URL>
          <FullURL>http://testphp.vulnweb.com/AJAX/htaccess.conf</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="30">
          <Name>disclaimer.php</Name>
          <URL>/disclaimer.php</URL>
          <FullURL>http://testphp.vulnweb.com/disclaimer.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="31">
          <Name>images</Name>
          <URL>/images/</URL>
          <FullURL>http://testphp.vulnweb.com/images/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="32">
          <Name>Mod_Rewrite_Shop</Name>
          <URL>/Mod_Rewrite_Shop/</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="33">
          <Name>images</Name>
          <URL>/Mod_Rewrite_Shop/images/</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/images/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="34">
          <Name>index.php</Name>
          <URL>/Mod_Rewrite_Shop/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/index.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="35">
          <Name>rate.php</Name>
          <URL>/Mod_Rewrite_Shop/rate.php</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/rate.php</FullURL>
          <Inputs>
            <Variable Name="id" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="36">
          <Name>details.php</Name>
          <URL>/Mod_Rewrite_Shop/details.php</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/details.php</FullURL>
          <Inputs>
            <Variable Name="id" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="37">
          <Name>buy.php</Name>
          <URL>/Mod_Rewrite_Shop/buy.php</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/buy.php</FullURL>
          <Inputs>
            <Variable Name="id" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="38">
          <Name>.htaccess</Name>
          <URL>/Mod_Rewrite_Shop/.htaccess</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/.htaccess</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="39">
          <Name>Details</Name>
          <URL>/Mod_Rewrite_Shop/Details</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="40">
          <Name>color-printer</Name>
          <URL>/Mod_Rewrite_Shop/Details/color-printer</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/color-printer</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="41">
          <Name>3</Name>
          <URL>/Mod_Rewrite_Shop/Details/color-printer/3/</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/color-printer/3/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="42">
          <Name>web-camera-a4tech</Name>
          <URL>/Mod_Rewrite_Shop/Details/web-camera-a4tech</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/web-camera-a4tech</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="43">
          <Name>2</Name>
          <URL>/Mod_Rewrite_Shop/Details/web-camera-a4tech/2/</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/web-camera-a4tech/2/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="44">
          <Name>network-attached-storage-dlink</Name>
          <URL>/Mod_Rewrite_Shop/Details/network-attached-storage-dlink</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/network-attached-storage-dlink</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="45">
          <Name>1</Name>
          <URL>/Mod_Rewrite_Shop/Details/network-attached-storage-dlink/1/</URL>
          <FullURL>http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/network-attached-storage-dlink/1/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="46">
          <Name>secured</Name>
          <URL>/secured/</URL>
          <FullURL>http://testphp.vulnweb.com/secured/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="47">
          <Name>newuser.php</Name>
          <URL>/secured/newuser.php</URL>
          <FullURL>http://testphp.vulnweb.com/secured/newuser.php</FullURL>
          <Inputs>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
            <Variable Name="signup" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/secured/newuser.php</URL>
              <PostData><![CDATA[signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=murdtvwl&amp;uuname=bsyoxcby]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="48">
          <Name>index.php</Name>
          <URL>/secured/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/secured/index.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="49">
          <Name>office.htm</Name>
          <URL>/secured/office.htm</URL>
          <FullURL>http://testphp.vulnweb.com/secured/office.htm</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="50">
          <Name>style.css</Name>
          <URL>/secured/style.css</URL>
          <FullURL>http://testphp.vulnweb.com/secured/style.css</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="51">
          <Name>phpinfo.php</Name>
          <URL>/secured/phpinfo.php</URL>
          <FullURL>http://testphp.vulnweb.com/secured/phpinfo.php</FullURL>
          <Inputs>
            <Variable Name="" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/secured/phpinfo.php?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/secured/phpinfo.php?=PHPE9568F35-D428-11d2-A769-00AA001ACF42</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/secured/phpinfo.php?=PHPE9568F34-D428-11d2-A769-00AA001ACF42</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="52">
          <Name>database_connect.php</Name>
          <URL>/secured/database_connect.php</URL>
          <FullURL>http://testphp.vulnweb.com/secured/database_connect.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="53">
          <Name>office_files</Name>
          <URL>/secured/office_files</URL>
          <FullURL>http://testphp.vulnweb.com/secured/office_files</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="54">
          <Name>filelist.xml</Name>
          <URL>/secured/office_files/filelist.xml</URL>
          <FullURL>http://testphp.vulnweb.com/secured/office_files/filelist.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="55">
          <Name>sendcommand.php</Name>
          <URL>/sendcommand.php</URL>
          <FullURL>http://testphp.vulnweb.com/sendcommand.php</FullURL>
          <Inputs>
            <Variable Name="cart_id" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="56">
          <Name>.idea</Name>
          <URL>/.idea/</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="57">
          <Name>misc.xml</Name>
          <URL>/.idea/misc.xml</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/misc.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="58">
          <Name>vcs.xml</Name>
          <URL>/.idea/vcs.xml</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/vcs.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="59">
          <Name>workspace.xml</Name>
          <URL>/.idea/workspace.xml</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/workspace.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="60">
          <Name>.name</Name>
          <URL>/.idea/.name</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/.name</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="61">
          <Name>scopes</Name>
          <URL>/.idea/scopes/</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/scopes/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="62">
          <Name>scope_settings.xml</Name>
          <URL>/.idea/scopes/scope_settings.xml</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/scopes/scope_settings.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="63">
          <Name>acuart.iml</Name>
          <URL>/.idea/acuart.iml</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/acuart.iml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="64">
          <Name>modules.xml</Name>
          <URL>/.idea/modules.xml</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/modules.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="65">
          <Name>encodings.xml</Name>
          <URL>/.idea/encodings.xml</URL>
          <FullURL>http://testphp.vulnweb.com/.idea/encodings.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="66">
          <Name>CVS</Name>
          <URL>/CVS/</URL>
          <FullURL>http://testphp.vulnweb.com/CVS/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="67">
          <Name>Entries.Log</Name>
          <URL>/CVS/Entries.Log</URL>
          <FullURL>http://testphp.vulnweb.com/CVS/Entries.Log</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="68">
          <Name>Repository</Name>
          <URL>/CVS/Repository</URL>
          <FullURL>http://testphp.vulnweb.com/CVS/Repository</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="69">
          <Name>Root</Name>
          <URL>/CVS/Root</URL>
          <FullURL>http://testphp.vulnweb.com/CVS/Root</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="70">
          <Name>Entries</Name>
          <URL>/CVS/Entries</URL>
          <FullURL>http://testphp.vulnweb.com/CVS/Entries</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="71">
          <Name>redir.php</Name>
          <URL>/redir.php</URL>
          <FullURL>http://testphp.vulnweb.com/redir.php</FullURL>
          <Inputs>
            <Variable Name="r" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/redir.php?r=http://www.eclectasy.com/Fractal-Explorer/index.html</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="72">
          <Name>_mmServerScripts</Name>
          <URL>/_mmServerScripts/</URL>
          <FullURL>http://testphp.vulnweb.com/_mmServerScripts/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="73">
          <Name>MMHTTPDB.php</Name>
          <URL>/_mmServerScripts/MMHTTPDB.php</URL>
          <FullURL>http://testphp.vulnweb.com/_mmServerScripts/MMHTTPDB.php</FullURL>
          <Inputs>
            <Variable Name="Type" Type="URL encoded POST">
       </Variable>
          </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="74">
          <Name>mysql.php</Name>
          <URL>/_mmServerScripts/mysql.php</URL>
          <FullURL>http://testphp.vulnweb.com/_mmServerScripts/mysql.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="75">
          <Name>comment.php</Name>
          <URL>/comment.php</URL>
          <FullURL>http://testphp.vulnweb.com/comment.php</FullURL>
          <Inputs>
            <Variable Name="aid" Type="URL encoded GET">
       </Variable>
            <Variable Name="aid" Type="URL encoded GET">
       </Variable>
            <Variable Name="pid" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="comment" Type="URL encoded POST">
       </Variable>
            <Variable Name="name" Type="URL encoded GET">
       </Variable>
            <Variable Name="name" Type="URL encoded GET">
       </Variable>
            <Variable Name="aid" Type="URL encoded GET">
       </Variable>
            <Variable Name="pid" Type="URL encoded GET">
       </Variable>
            <Variable Name="aid" Type="URL encoded GET">
       </Variable>
            <Variable Name="aid" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/comment.php</URL>
              <PostData><![CDATA[comment=1&amp;name=&lt;your%20name%20here&gt;&amp;phpaction=echo%20%24_POST%5bcomment%5d;&amp;Submit=Submit]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/comment.php?aid=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/comment.php?aid=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/comment.php?aid=3</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/comment.php?pid=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/comment.php?pid=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/comment.php?pid=3</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="76">
          <Name>wvstests</Name>
          <URL>/wvstests/</URL>
          <FullURL>http://testphp.vulnweb.com/wvstests/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="77">
          <Name>pmwiki_2_1_19</Name>
          <URL>/wvstests/pmwiki_2_1_19/</URL>
          <FullURL>http://testphp.vulnweb.com/wvstests/pmwiki_2_1_19/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="78">
          <Name>scripts</Name>
          <URL>/wvstests/pmwiki_2_1_19/scripts/</URL>
          <FullURL>http://testphp.vulnweb.com/wvstests/pmwiki_2_1_19/scripts/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="79">
          <Name>version.php</Name>
          <URL>/wvstests/pmwiki_2_1_19/scripts/version.php</URL>
          <FullURL>http://testphp.vulnweb.com/wvstests/pmwiki_2_1_19/scripts/version.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="80">
          <Name>pictures</Name>
          <URL>/pictures/</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="81">
          <Name>6.jpg.tn</Name>
          <URL>/pictures/6.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/6.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="82">
          <Name>3.jpg.tn</Name>
          <URL>/pictures/3.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/3.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="83">
          <Name>WS_FTP.LOG</Name>
          <URL>/pictures/WS_FTP.LOG</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/WS_FTP.LOG</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="84">
          <Name>wp-config.bak</Name>
          <URL>/pictures/wp-config.bak</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/wp-config.bak</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="85">
          <Name>ipaddresses.txt</Name>
          <URL>/pictures/ipaddresses.txt</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/ipaddresses.txt</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="86">
          <Name>path-disclosure-win.html</Name>
          <URL>/pictures/path-disclosure-win.html</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/path-disclosure-win.html</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="87">
          <Name>2.jpg.tn</Name>
          <URL>/pictures/2.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/2.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="88">
          <Name>5.jpg.tn</Name>
          <URL>/pictures/5.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/5.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="89">
          <Name>credentials.txt</Name>
          <URL>/pictures/credentials.txt</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/credentials.txt</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="90">
          <Name>4.jpg.tn</Name>
          <URL>/pictures/4.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/4.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="91">
          <Name>7.jpg.tn</Name>
          <URL>/pictures/7.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/7.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="92">
          <Name>path-disclosure-unix.html</Name>
          <URL>/pictures/path-disclosure-unix.html</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/path-disclosure-unix.html</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="93">
          <Name>1.jpg.tn</Name>
          <URL>/pictures/1.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/1.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="94">
          <Name>8.jpg.tn</Name>
          <URL>/pictures/8.jpg.tn</URL>
          <FullURL>http://testphp.vulnweb.com/pictures/8.jpg.tn</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="95">
          <Name>logout.php</Name>
          <URL>/logout.php</URL>
          <FullURL>http://testphp.vulnweb.com/logout.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="96">
          <Name>adm1nPan3l</Name>
          <URL>/adm1nPan3l/</URL>
          <FullURL>http://testphp.vulnweb.com/adm1nPan3l/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="97">
          <Name>index.php</Name>
          <URL>/adm1nPan3l/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/adm1nPan3l/index.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="98">
          <Name>admin</Name>
          <URL>/admin/</URL>
          <FullURL>http://testphp.vulnweb.com/admin/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="99">
          <Name>create.sql</Name>
          <URL>/admin/create.sql</URL>
          <FullURL>http://testphp.vulnweb.com/admin/create.sql</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="100">
          <Name>404.php</Name>
          <URL>/404.php</URL>
          <FullURL>http://testphp.vulnweb.com/404.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="101">
          <Name>Templates</Name>
          <URL>/Templates/</URL>
          <FullURL>http://testphp.vulnweb.com/Templates/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="102">
          <Name>main_dynamic_template.dwt.php</Name>
          <URL>/Templates/main_dynamic_template.dwt.php</URL>
          <FullURL>http://testphp.vulnweb.com/Templates/main_dynamic_template.dwt.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="103">
          <Name>index.bak</Name>
          <URL>/index.bak</URL>
          <FullURL>http://testphp.vulnweb.com/index.bak</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="104">
          <Name>product.php</Name>
          <URL>/product.php</URL>
          <FullURL>http://testphp.vulnweb.com/product.php</FullURL>
          <Inputs>
            <Variable Name="pic" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/product.php?pic=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/product.php?pic=3</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/product.php?pic=4</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="105">
          <Name>listproducts.php</Name>
          <URL>/listproducts.php</URL>
          <FullURL>http://testphp.vulnweb.com/listproducts.php</FullURL>
          <Inputs>
            <Variable Name="cat" Type="URL encoded GET">
       </Variable>
            <Variable Name="artist" Type="URL encoded GET">
       </Variable>
            <Variable Name="artist" Type="URL encoded GET">
       </Variable>
            <Variable Name="artist" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/listproducts.php?cat=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/listproducts.php?cat=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/listproducts.php?cat=4</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/listproducts.php?artist=2</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/listproducts.php?artist=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/listproducts.php?artist=3</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="106">
          <Name>clientaccesspolicy.xml</Name>
          <URL>/clientaccesspolicy.xml</URL>
          <FullURL>http://testphp.vulnweb.com/clientaccesspolicy.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="107">
          <Name>showimage.php</Name>
          <URL>/showimage.php</URL>
          <FullURL>http://testphp.vulnweb.com/showimage.php</FullURL>
          <Inputs>
            <Variable Name="file" Type="URL encoded GET">
       </Variable>
            <Variable Name="file" Type="URL encoded GET">
       </Variable>
            <Variable Name="file" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/showimage.php?file=./pictures/4.jpg&amp;size=160</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/showimage.php?file=./pictures/2.jpg&amp;size=160</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/showimage.php?file=./pictures/3.jpg&amp;size=160</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/showimage.php?file=./pictures/6.jpg&amp;size=160</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/showimage.php?file=./pictures/5.jpg&amp;size=160</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/showimage.php?file=./pictures/1.jpg&amp;size=160</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
            <Variation>
              <URL>http://testphp.vulnweb.com/showimage.php?file=./pictures/7.jpg&amp;size=160</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="108">
          <Name>signup.php</Name>
          <URL>/signup.php</URL>
          <FullURL>http://testphp.vulnweb.com/signup.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="109">
          <Name>clearguestbook.php</Name>
          <URL>/clearguestbook.php</URL>
          <FullURL>http://testphp.vulnweb.com/clearguestbook.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="110">
          <Name>bxss</Name>
          <URL>/bxss/</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="111">
          <Name>cleanDatabase.php</Name>
          <URL>/bxss/cleanDatabase.php</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/cleanDatabase.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="112">
          <Name>index.php</Name>
          <URL>/bxss/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/index.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="113">
          <Name>test.js</Name>
          <URL>/bxss/test.js</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/test.js</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="114">
          <Name>adminPan3l</Name>
          <URL>/bxss/adminPan3l/</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/adminPan3l/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="115">
          <Name>index.php</Name>
          <URL>/bxss/adminPan3l/index.php</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/adminPan3l/index.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="116">
          <Name>style.css</Name>
          <URL>/bxss/adminPan3l/style.css</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/adminPan3l/style.css</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="117">
          <Name>vuln.php</Name>
          <URL>/bxss/vuln.php</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/vuln.php</FullURL>
          <Inputs>
            <Variable Name="id" Type="URL encoded GET">
       </Variable>
          </Inputs>
          <Variations>
            <Variation>
              <URL>http://testphp.vulnweb.com/bxss/vuln.php?id=1</URL>
              <PostData><![CDATA[]]></PostData>
            </Variation>
          </Variations>
        </SiteFile>
        <SiteFile id="118">
          <Name>database_connect.php</Name>
          <URL>/bxss/database_connect.php</URL>
          <FullURL>http://testphp.vulnweb.com/bxss/database_connect.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="119">
          <Name>crossdomain.xml</Name>
          <URL>/crossdomain.xml</URL>
          <FullURL>http://testphp.vulnweb.com/crossdomain.xml</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="120">
          <Name>Connections</Name>
          <URL>/Connections/</URL>
          <FullURL>http://testphp.vulnweb.com/Connections/</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="121">
          <Name>DB_Connection.php</Name>
          <URL>/Connections/DB_Connection.php</URL>
          <FullURL>http://testphp.vulnweb.com/Connections/DB_Connection.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="122">
          <Name>database_connect.php</Name>
          <URL>/database_connect.php</URL>
          <FullURL>http://testphp.vulnweb.com/database_connect.php</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="123">
          <Name>medias</Name>
          <URL>/medias</URL>
          <FullURL>http://testphp.vulnweb.com/medias</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="124">
          <Name>img</Name>
          <URL>/medias/img</URL>
          <FullURL>http://testphp.vulnweb.com/medias/img</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="125">
          <Name>css</Name>
          <URL>/medias/css</URL>
          <FullURL>http://testphp.vulnweb.com/medias/css</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="126">
          <Name>main.css</Name>
          <URL>/medias/css/main.css</URL>
          <FullURL>http://testphp.vulnweb.com/medias/css/main.css</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="127">
          <Name>js</Name>
          <URL>/medias/js</URL>
          <FullURL>http://testphp.vulnweb.com/medias/js</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
        <SiteFile id="128">
          <Name>common_functions.js</Name>
          <URL>/medias/js/common_functions.js</URL>
          <FullURL>http://testphp.vulnweb.com/medias/js/common_functions.js</FullURL>
          <Inputs>
      </Inputs>
          <Variations>
      </Variations>
        </SiteFile>
      </SiteFiles>
    </Crawler>
    <ReportItems>
      <ReportItem id="0" color="orange">
        <Name><![CDATA[HTML form without CSRF protection]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">&lt;empty&gt;</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/search.php?test=query</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>searchFor [Text]</li><li>goButton [Submit]</li></ul>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[An attacker may force the users of a web application to execute actions of the attacker''s choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application. ]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div><br/>
Cross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.

<br/><br/>Acunetix WVS found a HTML form with no apparent CSRF protection implemented. Consult details for more information about the affected HTML form.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check if this form requires CSRF protection and implement CSRF countermeasures if necessary.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:11 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="352"><![CDATA[CWE-352]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:H/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[2.6]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[High]]></AC>
          <ACdesc><![CDATA[Specialized access conditions exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="1" color="blue">
        <Name><![CDATA[Clickjacking: X-Frame-Options header missing]]></Name>
        <ModuleName><![CDATA[Scripting (Clickjacking_X_Frame_Options.script)]]></ModuleName>
        <Details><![CDATA[No details are available.]]></Details>
        <Affects><![CDATA[Web Server]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[The impact depends on the affected web application. ]]></Impact>
        <Description><![CDATA[Clickjacking (User Interface redress attack, UI redress attack, UI redressing) is a malicious technique of tricking a Web user into clicking on something different from what the user perceives they are clicking on, thus potentially revealing confidential information or taking control of their computer while clicking on seemingly innocuous web pages. <br/><br/>
The server didn't return an <b>X-Frame-Options</b> header which means that this website could be at risk of a clickjacking attack. The X-Frame-Options HTTP response header can be used to indicate whether or not a browser should be allowed to render a page in a &lt;frame&gt; or &lt;iframe&gt;. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.
]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Configure your web server to include an  X-Frame-Options header. Consult Web references for more information about the possible values for this header.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:11 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="693"><![CDATA[CWE-693]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[The X-Frame-Options response header]]></Database>
            <URL><![CDATA[https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Clickjacking]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Clickjacking]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Original Clickjacking paper]]></Database>
            <URL><![CDATA[http://www.sectheory.com/clickjacking.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="2" color="orange">
        <Name><![CDATA[Insecure crossdomain.xml file]]></Name>
        <ModuleName><![CDATA[Scripting (Crossdomain_XML.script)]]></ModuleName>
        <Details><![CDATA[The crossdomain.xml file is located at <b>/crossdomain.xml</b>]]></Details>
        <Affects><![CDATA[Web Server]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[Using an insecure cross-domain policy file could expose your site to various attacks.]]></Impact>
        <Description><![CDATA[The browser security model normally prevents web content from one domain from accessing data from another domain. This is commonly known as the &quot;same origin policy&quot;.  URL policy files grant cross-domain permissions for reading data. They permit operations that are not permitted by default. The URL policy file is located, by default, in the root directory of the target server, with the name crossdomain.xml (for example, at www.example.com/crossdomain.xml). <br/><br/> When a domain is specified in crossdomain.xml file, the site declares that it is willing to allow the operators of any servers in that domain to obtain any document on the server where the policy file resides. The crossdomain.xml file deployed on this website opens the server to all domains (use of a single asterisk &quot;*&quot; as a pure wildcard is supported) like so:
<pre wrap="virtual">
&lt;cross-domain-policy&gt;
&lt;allow-access-from domain=&quot;*&quot; /&gt;
&lt;/cross-domain-policy&gt;
</pre>

This practice is suitable for public servers, but should not be used for sites located behind a firewall because it could permit access to protected areas. It should not be used for sites that require authentication in the form of passwords or cookies. Sites that use the common practice of authentication based on cookies to access private or user-specific data should be especially careful when using cross-domain policy files.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Carefully evaluate which sites will be allowed to make cross-domain calls. Consider network topology and any authentication mechanisms that will be affected by the configuration or implementation of the cross-domain policy.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /crossdomain.xml HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:12 GMT
Content-Type: text/xml
Content-Length: 224
Last-Modified: Tue, 11 Sep 2012 10:30:22 GMT
Connection: keep-alive
ETag: &quot;504f12be-e0&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="284"><![CDATA[CWE-284]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Cross-domain policy file usage recommendations for Flash Player]]></Database>
            <URL><![CDATA[http://www.adobe.com/devnet/flashplayer/articles/cross_domain_policy.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross-domain policy files]]></Database>
            <URL><![CDATA[http://blogs.adobe.com/stateofsecurity/2007/07/crossdomain_policy_files_1.html]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="3" color="green">
        <Name><![CDATA[Password type input with auto-complete enabled]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Password type input named <b><font color="dark">pass</font></b> from form named <b>loginform</b> with action <b>userinfo.php</b> has autocomplete enabled.]]></Details>
        <Affects><![CDATA[/login.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[When a new name and password is entered in a form and the form is submitted, the browser asks if the password should be saved.Thereafter when the form is displayed, the name and password are filled in automatically or are completed as the name is entered. An attacker with local access could obtain the cleartext password from the browser cache.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[The password auto-complete should be disabled in sensitive applications. <br/>To disable auto-complete, you may use a code similar to: <pre wrap="virtual"><code>&lt;INPUT TYPE=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot;&gt;</code></pre>]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /login.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:15 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4671
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="4" color="orange">
        <Name><![CDATA[User credentials are sent in clear text]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">loginform</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/userinfo.php</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>uname [Text]</li><li>pass [Password]</li></ul>]]></Details>
        <Affects><![CDATA[/login.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[A third party may be able to read the user credentials by intercepting an unencrypted HTTP connection.]]></Impact>
        <Description><![CDATA[User credentials are transmitted over an unencrypted channel. This information should always be transferred via an encrypted channel (HTTPS) to avoid being intercepted by malicious users.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Because user credentials are considered sensitive information, should always be transferred to the server over an encrypted connection (HTTPS).]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /login.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:15 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4671
]]></Response>
        </TechnicalDetails>
        <CWE id="310"><![CDATA[CWE-310]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N/E:H/RL:W/RC:C]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[High]]></E>
          <Edesc><![CDATA[Either the vulnerability is exploitable by functional mobile autonomous code, or no exploit is required (manual trigger) and details are widely available.]]></Edesc>
          <RL><![CDATA[Workaround]]></RL>
          <RLdesc><![CDATA[There is an unofficial, non-vendor solution available. In some cases, users of the affected technology will create a patch of their own or provide steps to work around or otherwise mitigate the vulnerability.]]></RLdesc>
          <RC><![CDATA[Confirmed]]></RC>
          <RCdesc><![CDATA[The vulnerability has been acknowledged by the vendor or author of the affected technology.]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="5" color="orange">
        <Name><![CDATA[HTML form without CSRF protection]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">loginform</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/userinfo.php</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>uname [Text]</li><li>pass [Password]</li></ul>]]></Details>
        <Affects><![CDATA[/login.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[An attacker may force the users of a web application to execute actions of the attacker''s choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application. ]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div><br/>
Cross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.

<br/><br/>Acunetix WVS found a HTML form with no apparent CSRF protection implemented. Consult details for more information about the affected HTML form.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check if this form requires CSRF protection and implement CSRF countermeasures if necessary.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /login.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:15 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4671
]]></Response>
        </TechnicalDetails>
        <CWE id="352"><![CDATA[CWE-352]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:H/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[2.6]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[High]]></AC>
          <ACdesc><![CDATA[Specialized access conditions exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="6" color="orange">
        <Name><![CDATA[HTML form without CSRF protection]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">faddentry</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/guestbook.php</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>name [Hidden]</li><li>text [TextArea]</li><li>submit [Submit]</li></ul>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[An attacker may force the users of a web application to execute actions of the attacker''s choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application. ]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div><br/>
Cross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.

<br/><br/>Acunetix WVS found a HTML form with no apparent CSRF protection implemented. Consult details for more information about the affected HTML form.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check if this form requires CSRF protection and implement CSRF countermeasures if necessary.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /guestbook.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:17 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4531
]]></Response>
        </TechnicalDetails>
        <CWE id="352"><![CDATA[CWE-352]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:H/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[2.6]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[High]]></AC>
          <ACdesc><![CDATA[Specialized access conditions exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="7" color="green">
        <Name><![CDATA[Broken links]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[For a complete list of URLs linking to this file, go to Site Structure &gt; Locate and select the file (marked as &quot;Not Found&quot;) &gt; select Referrers Tab from the bottom of the Information pane.]]></Details>
        <Affects><![CDATA[/privacy.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Problems navigating the site.]]></Impact>
        <Description><![CDATA[A broken link refers to any link that should take you to a document, image or webpage, that actually results in an error. This page was linked from the website but it is inaccessible.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the links to this file or make it accessible.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /privacy.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 404 Not Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:16 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 16
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="8" color="green">
        <Name><![CDATA[GHDB: phpinfo()]]></Name>
        <ModuleName><![CDATA[GHDB]]></ModuleName>
        <Details><![CDATA[We found <pre wrap="virtual"><font color="blue">intitle:phpinfo &quot;PHP Version&quot;</font></pre>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Not available. Check description.]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">The description for this alert is contributed by the GHDB community, it may contain inappropriate language.</font></div><br/><font color="navy">Category : Files containing juicy info</font><br/><br/>this brings up sites with phpinfo(). There is SO much cool stuff in here that you just have to check one out for yourself! I mean full blown system versioning, SSL version, sendmail version and path, ftp, LDAP, SQL info, Apache mods, Apache env vars, *sigh* the list goes on and on! Thanks &quot;joe!&quot; =)<br/><br/>The Google Hacking Database (GHDB) appears courtesy of the Google Hacking community.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Not available. Check description.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id=""><![CDATA[]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[]]></Descriptor>
          <Score><![CDATA[]]></Score>
          <AV><![CDATA[]]></AV>
          <AVdesc><![CDATA[]]></AVdesc>
          <AC><![CDATA[]]></AC>
          <ACdesc><![CDATA[]]></ACdesc>
          <Au><![CDATA[]]></Au>
          <Audesc><![CDATA[]]></Audesc>
          <C><![CDATA[]]></C>
          <Cdesc><![CDATA[]]></Cdesc>
          <I><![CDATA[]]></I>
          <Idesc><![CDATA[]]></Idesc>
          <A><![CDATA[]]></A>
          <Adesc><![CDATA[]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[The Google Hacking Database (GHDB) community]]></Database>
            <URL><![CDATA[http://johnny.ihackstuff.com/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Acunetix Google hacking]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/google-hacking.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="9" color="green">
        <Name><![CDATA[GHDB: Default phpinfo page]]></Name>
        <ModuleName><![CDATA[GHDB]]></ModuleName>
        <Details><![CDATA[We found <pre wrap="virtual"><font color="blue">intitle:&quot;phpinfo()&quot; +&quot;mysql.default_password&quot; +&quot;Zend Scripting Language Engine&quot;</font></pre>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Not available. Check description.]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">The description for this alert is contributed by the GHDB community, it may contain inappropriate language.</font></div><br/><font color="navy">Category : Files containing passwords</font><br/><br/>This will look throught default phpinfo pages for ones that have a default mysql password.<br/><br/>The Google Hacking Database (GHDB) appears courtesy of the Google Hacking community.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Not available. Check description.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id=""><![CDATA[]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[]]></Descriptor>
          <Score><![CDATA[]]></Score>
          <AV><![CDATA[]]></AV>
          <AVdesc><![CDATA[]]></AVdesc>
          <AC><![CDATA[]]></AC>
          <ACdesc><![CDATA[]]></ACdesc>
          <Au><![CDATA[]]></Au>
          <Audesc><![CDATA[]]></Audesc>
          <C><![CDATA[]]></C>
          <Cdesc><![CDATA[]]></Cdesc>
          <I><![CDATA[]]></I>
          <Idesc><![CDATA[]]></Idesc>
          <A><![CDATA[]]></A>
          <Adesc><![CDATA[]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[The Google Hacking Database (GHDB) community]]></Database>
            <URL><![CDATA[http://johnny.ihackstuff.com/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Acunetix Google hacking]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/google-hacking.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="10" color="green">
        <Name><![CDATA[GHDB: SQL error message]]></Name>
        <ModuleName><![CDATA[GHDB]]></ModuleName>
        <Details><![CDATA[We found <pre wrap="virtual"><font color="blue">&quot;access denied for user&quot; &quot;using password&quot; -documentation</font></pre>]]></Details>
        <Affects><![CDATA[/secured/database_connect.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Not available. Check description.]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">The description for this alert is contributed by the GHDB community, it may contain inappropriate language.</font></div><br/><font color="navy">Category : Error Messages</font><br/><br/>Another SQL error message, this message can display the username, database, path names and partial SQL code, all of which are very helpful for hackers...<br/><br/>The Google Hacking Database (GHDB) appears courtesy of the Google Hacking community.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Not available. Check description.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/database_connect.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 251
]]></Response>
        </TechnicalDetails>
        <CWE id=""><![CDATA[]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[]]></Descriptor>
          <Score><![CDATA[]]></Score>
          <AV><![CDATA[]]></AV>
          <AVdesc><![CDATA[]]></AVdesc>
          <AC><![CDATA[]]></AC>
          <ACdesc><![CDATA[]]></ACdesc>
          <Au><![CDATA[]]></Au>
          <Audesc><![CDATA[]]></Audesc>
          <C><![CDATA[]]></C>
          <Cdesc><![CDATA[]]></Cdesc>
          <I><![CDATA[]]></I>
          <Idesc><![CDATA[]]></Idesc>
          <A><![CDATA[]]></A>
          <Adesc><![CDATA[]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[The Google Hacking Database (GHDB) community]]></Database>
            <URL><![CDATA[http://johnny.ihackstuff.com/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Acunetix Google hacking]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/google-hacking.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="11" color="red">
        <Name><![CDATA[nginx SPDY heap buffer overflow]]></Name>
        <ModuleName><![CDATA[Scripting (Version_Check.script)]]></ModuleName>
        <Details><![CDATA[Current version is : <font color="dark">nginx/1.4.1</font>]]></Details>
        <Affects><![CDATA[Web Server]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[An attacker can cause a heap memory buffer overflow in a worker process by using a specially crafted request, potentially
resulting in arbitrary code execution ]]></Impact>
        <Description><![CDATA[A heap-based buffer overflow in the SPDY implementation in nginx 1.3.15 before 1.4.7 and 1.5.x before 1.5.12 allows remote attackers to execute arbitrary code via a crafted request. The problem affects nginx compiled with the ngx_http_spdy_module module (which is not compiled by default) and without --with-debug configure option, if the &quot;spdy&quot; option of the &quot;listen&quot; directive is used in a configuration file.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Upgrade nginx to the latest version of apply the patch provided by the vendor.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[]]></Request>
          <Response><![CDATA[]]></Response>
        </TechnicalDetails>
        <CWE id="122"><![CDATA[CWE-122]]></CWE>
        <CVEList>
          <CVE>
            <Id><![CDATA[CVE-2014-0133]]></Id>
          </CVE>
        </CVEList>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF]]></Descriptor>
          <Score><![CDATA[5.1]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[High]]></AC>
          <ACdesc><![CDATA[Specialized access conditions exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[Proof of concept code]]></E>
          <Edesc><![CDATA[Proof-of-concept exploit code or an attack demonstration that is not practical for most systems is available. The code or technique is not functional in all situations and may require substantial modification by a skilled attacker.]]></Edesc>
          <RL><![CDATA[Official fix]]></RL>
          <RLdesc><![CDATA[A complete vendor solution is available. Either the vendor has issued an official patch, or an upgrade is available.]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[nginx security advisory (CVE-2014-0133)]]></Database>
            <URL><![CDATA[http://mailman.nginx.org/pipermail/nginx-announce/2014/000135.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[nginx patch]]></Database>
            <URL><![CDATA[http://nginx.org/download/patch.2014.spdy2.txt]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="12" color="orange">
        <Name><![CDATA[HTML form without CSRF protection]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">fComment</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/comment.php</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>name [Text]</li><li>comment [TextArea]</li><li>Submit [Submit]</li><li>phpaction [Hidden]</li></ul>]]></Details>
        <Affects><![CDATA[/comment.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[An attacker may force the users of a web application to execute actions of the attacker''s choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application. ]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div><br/>
Cross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.

<br/><br/>Acunetix WVS found a HTML form with no apparent CSRF protection implemented. Consult details for more information about the affected HTML form.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check if this form requires CSRF protection and implement CSRF countermeasures if necessary.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /comment.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 302 Object moved
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:30 GMT
Content-Type: text/html
Content-Length: 1246
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Location: ./index.php
]]></Response>
        </TechnicalDetails>
        <CWE id="352"><![CDATA[CWE-352]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:H/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[2.6]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[High]]></AC>
          <ACdesc><![CDATA[Specialized access conditions exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="13" color="blue">
        <Name><![CDATA[Possible virtual host found]]></Name>
        <ModuleName><![CDATA[Scripting (VirtualHost_Audit.script)]]></ModuleName>
        <Details><![CDATA[VirtualHost: <font color="dark"><b>localhost</b></font><br/>Response: <pre wrap="virtual"><font color="blue">
</font></pre>]]></Details>
        <Affects><![CDATA[localhost]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[Virtual hosting is a method for hosting multiple domain names (with separate handling of each name) on a single server (or pool of servers). This allows one server to share its resources, such as memory and processor cycles, without requiring all services provided to use the same host name. <br/><br/>
This web server is responding differently when the Host header is manipulated and various common virtual hosts are tested. This could indicate there is a Virtual Host present.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Consult the virtual host configuration and check if this virtual host should be publicly accessible. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.0
Host: localhost
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
User-Agent: Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:35 GMT
Content-Type: text/html
Content-Length: 612
Last-Modified: Mon, 06 May 2013 11:30:13 GMT
Connection: close
ETag: &quot;51879445-264&quot;
Accept-Ranges: bytes]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Virtual hosting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Virtual_hosting]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="14" color="green">
        <Name><![CDATA[GHDB: Sablotron error message]]></Name>
        <ModuleName><![CDATA[GHDB]]></ModuleName>
        <Details><![CDATA[We found <pre wrap="virtual"><font color="blue">warning &quot;error on line&quot; php sablotron</font></pre>]]></Details>
        <Affects><![CDATA[/pictures/path-disclosure-unix.html]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Not available. Check description.]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">The description for this alert is contributed by the GHDB community, it may contain inappropriate language.</font></div><br/><font color="navy">Category : Error Messages</font><br/><br/>Sablotron is an XML toolit thingie. This query hones in on error messages generated by this toolkit. These error messages reveal all sorts of interesting stuff such as source code snippets, path and filename info, etc.<br/><br/>The Google Hacking Database (GHDB) appears courtesy of the Google Hacking community.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Not available. Check description.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures/path-disclosure-unix.html HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:35 GMT
Content-Type: text/html
Last-Modified: Mon, 08 Apr 2013 08:42:10 GMT
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 3936
]]></Response>
        </TechnicalDetails>
        <CWE id=""><![CDATA[]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[]]></Descriptor>
          <Score><![CDATA[]]></Score>
          <AV><![CDATA[]]></AV>
          <AVdesc><![CDATA[]]></AVdesc>
          <AC><![CDATA[]]></AC>
          <ACdesc><![CDATA[]]></ACdesc>
          <Au><![CDATA[]]></Au>
          <Audesc><![CDATA[]]></Audesc>
          <C><![CDATA[]]></C>
          <Cdesc><![CDATA[]]></Cdesc>
          <I><![CDATA[]]></I>
          <Idesc><![CDATA[]]></Idesc>
          <A><![CDATA[]]></A>
          <Adesc><![CDATA[]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[The Google Hacking Database (GHDB) community]]></Database>
            <URL><![CDATA[http://johnny.ihackstuff.com/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Acunetix Google hacking]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/google-hacking.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="15" color="green">
        <Name><![CDATA[Password type input with auto-complete enabled]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Password type input named <b><font color="dark">upass</font></b> from form named <b>form1</b> with action <b>/secured/newuser.php</b> has autocomplete enabled.]]></Details>
        <Affects><![CDATA[/signup.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[When a new name and password is entered in a form and the form is submitted, the browser asks if the password should be saved.Thereafter when the form is displayed, the name and password are filled in automatically or are completed as the name is entered. An attacker with local access could obtain the cleartext password from the browser cache.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[The password auto-complete should be disabled in sensitive applications. <br/>To disable auto-complete, you may use a code similar to: <pre wrap="virtual"><code>&lt;INPUT TYPE=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot;&gt;</code></pre>]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /signup.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5183
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="16" color="green">
        <Name><![CDATA[Password type input with auto-complete enabled]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Password type input named <b><font color="dark">upass2</font></b> from form named <b>form1</b> with action <b>/secured/newuser.php</b> has autocomplete enabled.]]></Details>
        <Affects><![CDATA[/signup.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[When a new name and password is entered in a form and the form is submitted, the browser asks if the password should be saved.Thereafter when the form is displayed, the name and password are filled in automatically or are completed as the name is entered. An attacker with local access could obtain the cleartext password from the browser cache.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[The password auto-complete should be disabled in sensitive applications. <br/>To disable auto-complete, you may use a code similar to: <pre wrap="virtual"><code>&lt;INPUT TYPE=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot;&gt;</code></pre>]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /signup.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5183
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="17" color="orange">
        <Name><![CDATA[User credentials are sent in clear text]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">form1</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/secured/newuser.php</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>uuname [Text]</li><li>upass [Password]</li><li>upass2 [Password]</li><li>urname [Text]</li><li>ucc [Text]</li><li>uemail [Text]</li><li>uphone [Text]</li><li>uaddress [TextArea]</li><li>signup [Submit]</li></ul>]]></Details>
        <Affects><![CDATA[/signup.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[A third party may be able to read the user credentials by intercepting an unencrypted HTTP connection.]]></Impact>
        <Description><![CDATA[User credentials are transmitted over an unencrypted channel. This information should always be transferred via an encrypted channel (HTTPS) to avoid being intercepted by malicious users.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Because user credentials are considered sensitive information, should always be transferred to the server over an encrypted connection (HTTPS).]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /signup.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5183
]]></Response>
        </TechnicalDetails>
        <CWE id="310"><![CDATA[CWE-310]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N/E:H/RL:W/RC:C]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[High]]></E>
          <Edesc><![CDATA[Either the vulnerability is exploitable by functional mobile autonomous code, or no exploit is required (manual trigger) and details are widely available.]]></Edesc>
          <RL><![CDATA[Workaround]]></RL>
          <RLdesc><![CDATA[There is an unofficial, non-vendor solution available. In some cases, users of the affected technology will create a patch of their own or provide steps to work around or otherwise mitigate the vulnerability.]]></RLdesc>
          <RC><![CDATA[Confirmed]]></RC>
          <RCdesc><![CDATA[The vulnerability has been acknowledged by the vendor or author of the affected technology.]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="18" color="orange">
        <Name><![CDATA[HTML form without CSRF protection]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">form1</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/secured/newuser.php</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>uuname [Text]</li><li>upass [Password]</li><li>upass2 [Password]</li><li>urname [Text]</li><li>ucc [Text]</li><li>uemail [Text]</li><li>uphone [Text]</li><li>uaddress [TextArea]</li><li>signup [Submit]</li></ul>]]></Details>
        <Affects><![CDATA[/signup.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[An attacker may force the users of a web application to execute actions of the attacker''s choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application. ]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div><br/>
Cross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.

<br/><br/>Acunetix WVS found a HTML form with no apparent CSRF protection implemented. Consult details for more information about the affected HTML form.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check if this form requires CSRF protection and implement CSRF countermeasures if necessary.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /signup.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5183
]]></Response>
        </TechnicalDetails>
        <CWE id="352"><![CDATA[CWE-352]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:H/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[2.6]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[High]]></AC>
          <ACdesc><![CDATA[Specialized access conditions exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="19" color="green">
        <Name><![CDATA[GHDB: SQL error message]]></Name>
        <ModuleName><![CDATA[GHDB]]></ModuleName>
        <Details><![CDATA[We found <pre wrap="virtual"><font color="blue">&quot;access denied for user&quot; &quot;using password&quot; -documentation</font></pre>]]></Details>
        <Affects><![CDATA[/Connections/DB_Connection.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Not available. Check description.]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">The description for this alert is contributed by the GHDB community, it may contain inappropriate language.</font></div><br/><font color="navy">Category : Error Messages</font><br/><br/>Another SQL error message, this message can display the username, database, path names and partial SQL code, all of which are very helpful for hackers...<br/><br/>The Google Hacking Database (GHDB) appears courtesy of the Google Hacking community.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Not available. Check description.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Connections/DB_Connection.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:38 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 332
]]></Response>
        </TechnicalDetails>
        <CWE id=""><![CDATA[]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[]]></Descriptor>
          <Score><![CDATA[]]></Score>
          <AV><![CDATA[]]></AV>
          <AVdesc><![CDATA[]]></AVdesc>
          <AC><![CDATA[]]></AC>
          <ACdesc><![CDATA[]]></ACdesc>
          <Au><![CDATA[]]></Au>
          <Audesc><![CDATA[]]></Audesc>
          <C><![CDATA[]]></C>
          <Cdesc><![CDATA[]]></Cdesc>
          <I><![CDATA[]]></I>
          <Idesc><![CDATA[]]></Idesc>
          <A><![CDATA[]]></A>
          <Adesc><![CDATA[]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[The Google Hacking Database (GHDB) community]]></Database>
            <URL><![CDATA[http://johnny.ihackstuff.com/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Acunetix Google hacking]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/google-hacking.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="20" color="blue">
        <Name><![CDATA[Hidden form input named price was found]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">f_addcart</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/cart.php</font><br/>Form method: <font color="navy">POST</font><br/><br/>Form inputs:<br/><ul><li>price [Hidden]</li><li>addcart [Hidden]</li></ul>]]></Details>
        <Affects><![CDATA[/product.php (81ef31a0ec1c92a6e1e1f13920e6b150)]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[User may change price information before submitting the form.]]></Impact>
        <Description><![CDATA[A hidden form input named price was found. It's not recommended to hide sensitive information in hidden form fields.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check if the script inputs are properly validated.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /product.php?pic=3 HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/search.php
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:48 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5540
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="21" color="green">
        <Name><![CDATA[Broken links]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[For a complete list of URLs linking to this file, go to Site Structure &gt; Locate and select the file (marked as &quot;Not Found&quot;) &gt; select Referrers Tab from the bottom of the Information pane.]]></Details>
        <Affects><![CDATA[/secured/office_files/filelist.xml]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Problems navigating the site.]]></Impact>
        <Description><![CDATA[A broken link refers to any link that should take you to a document, image or webpage, that actually results in an error. This page was linked from the website but it is inaccessible.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the links to this file or make it accessible.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/office_files/filelist.xml HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/secured/office.htm
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 404 Not Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:50 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 570
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="22" color="green">
        <Name><![CDATA[Broken links]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[For a complete list of URLs linking to this file, go to Site Structure &gt; Locate and select the file (marked as &quot;Not Found&quot;) &gt; select Referrers Tab from the bottom of the Information pane.]]></Details>
        <Affects><![CDATA[/medias/css/main.css]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Problems navigating the site.]]></Impact>
        <Description><![CDATA[A broken link refers to any link that should take you to a document, image or webpage, that actually results in an error. This page was linked from the website but it is inaccessible.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the links to this file or make it accessible.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /medias/css/main.css HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/pictures/path-disclosure-unix.html
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 404 Not Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:51 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 570
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="23" color="green">
        <Name><![CDATA[Broken links]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[For a complete list of URLs linking to this file, go to Site Structure &gt; Locate and select the file (marked as &quot;Not Found&quot;) &gt; select Referrers Tab from the bottom of the Information pane.]]></Details>
        <Affects><![CDATA[/medias/js/common_functions.js]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Problems navigating the site.]]></Impact>
        <Description><![CDATA[A broken link refers to any link that should take you to a document, image or webpage, that actually results in an error. This page was linked from the website but it is inaccessible.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the links to this file or make it accessible.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /medias/js/common_functions.js HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/pictures/path-disclosure-unix.html
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 404 Not Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:51 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 570
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="24" color="orange">
        <Name><![CDATA[HTML form without CSRF protection]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Form name: <font color="navy">&lt;empty&gt;</font><br/>Form action: <font color="navy">http://testphp.vulnweb.com/hpp/params.php?p=valid&amp;pp=12</font><br/>Form method: <font color="navy">GET</font><br/><br/>Form inputs:<br/><ul><li>aaaa/ [Submit]</li></ul>]]></Details>
        <Affects><![CDATA[/hpp/index.php (914f51fea3c42cbd541a6953a8b115a4)]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[An attacker may force the users of a web application to execute actions of the attacker''s choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application. ]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div><br/>
Cross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.

<br/><br/>Acunetix WVS found a HTML form with no apparent CSRF protection implemented. Consult details for more information about the affected HTML form.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check if this form requires CSRF protection and implement CSRF countermeasures if necessary.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/index.php?pp=12 HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/hpp/index.php
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:51 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 383
]]></Response>
        </TechnicalDetails>
        <CWE id="352"><![CDATA[CWE-352]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:H/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[2.6]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[High]]></AC>
          <ACdesc><![CDATA[Specialized access conditions exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="25" color="green">
        <Name><![CDATA[Broken links]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[For a complete list of URLs linking to this file, go to Site Structure &gt; Locate and select the file (marked as &quot;Not Found&quot;) &gt; select Referrers Tab from the bottom of the Information pane.]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/Details/color-printer/3]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Problems navigating the site.]]></Impact>
        <Description><![CDATA[A broken link refers to any link that should take you to a document, image or webpage, that actually results in an error. This page was linked from the website but it is inaccessible.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the links to this file or make it accessible.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/Details/color-printer/3/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/color-printer/3
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 404 Not Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:52 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 570
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="26" color="green">
        <Name><![CDATA[Broken links]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[For a complete list of URLs linking to this file, go to Site Structure &gt; Locate and select the file (marked as &quot;Not Found&quot;) &gt; select Referrers Tab from the bottom of the Information pane.]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/Details/network-attached-storage-dlink/1]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Problems navigating the site.]]></Impact>
        <Description><![CDATA[A broken link refers to any link that should take you to a document, image or webpage, that actually results in an error. This page was linked from the website but it is inaccessible.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the links to this file or make it accessible.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/Details/network-attached-storage-dlink/1/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/network-attached-storage-dlink/1
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 404 Not Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:52 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 570
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="27" color="green">
        <Name><![CDATA[Broken links]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[For a complete list of URLs linking to this file, go to Site Structure &gt; Locate and select the file (marked as &quot;Not Found&quot;) &gt; select Referrers Tab from the bottom of the Information pane.]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/Details/web-camera-a4tech/2]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Problems navigating the site.]]></Impact>
        <Description><![CDATA[A broken link refers to any link that should take you to a document, image or webpage, that actually results in an error. This page was linked from the website but it is inaccessible.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the links to this file or make it accessible.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/Details/web-camera-a4tech/2/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/Mod_Rewrite_Shop/Details/web-camera-a4tech/2
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 404 Not Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:52 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 570
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="28" color="blue">
        <Name><![CDATA[Session Cookie without HttpOnly flag set]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Cookie name: <font color="dark">&quot;login&quot;</font><br/>Cookie domain: <font color="dark">&quot;testphp.vulnweb.com&quot;</font><br/>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[None]]></Impact>
        <Description><![CDATA[This cookie does not have the HTTPOnly flag set. When a cookie is set with the HTTPOnly flag, it instructs the browser that the cookie can only be accessed by the server and not by client-side scripts. This is an important security protection for session cookies.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[If possible, you should set the HTTPOnly flag for this cookie.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: filelist;aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:13 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="29" color="blue">
        <Name><![CDATA[Session Cookie without Secure flag set]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Cookie name: <font color="dark">&quot;login&quot;</font><br/>Cookie domain: <font color="dark">&quot;testphp.vulnweb.com&quot;</font><br/>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[None]]></Impact>
        <Description><![CDATA[This cookie does not have the Secure flag set. When a cookie is set with the Secure flag, it instructs the browser that the cookie can only be accessed over secure SSL channels. This is an important security protection for session cookies.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[If possible, you should set the Secure flag for this cookie.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: filelist;aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:13 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="30" color="blue">
        <Name><![CDATA[Session Cookie without HttpOnly flag set]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Cookie name: <font color="dark">&quot;mycookie&quot;</font><br/>Cookie domain: <font color="dark">&quot;testphp.vulnweb.com&quot;</font><br/>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[None]]></Impact>
        <Description><![CDATA[This cookie does not have the HTTPOnly flag set. When a cookie is set with the HTTPOnly flag, it instructs the browser that the cookie can only be accessed by the server and not by client-side scripts. This is an important security protection for session cookies.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[If possible, you should set the HTTPOnly flag for this cookie.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: filelist;aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:13 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="31" color="blue">
        <Name><![CDATA[Session Cookie without Secure flag set]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[Cookie name: <font color="dark">&quot;mycookie&quot;</font><br/>Cookie domain: <font color="dark">&quot;testphp.vulnweb.com&quot;</font><br/>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[None]]></Impact>
        <Description><![CDATA[This cookie does not have the Secure flag set. When a cookie is set with the Secure flag, it instructs the browser that the cookie can only be accessed over secure SSL channels. This is an important security protection for session cookies.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[If possible, you should set the Secure flag for this cookie.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: filelist;aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:13 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="32" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">p</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(951846)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/hpp/params.php]]></Affects>
        <Parameter><![CDATA[p]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/params.php?p=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(951846)&lt;/ScRiPt&gt;&amp;pp=1 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:28 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 40
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="33" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(994936)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/hpp/params.php]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/params.php?p=1&amp;pp=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(994936)&lt;/ScRiPt&gt; HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:28 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 40
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="34" color="orange">
        <Name><![CDATA[Application error message]]></Name>
        <ModuleName><![CDATA[Scripting (Error_Message.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uuname</font></b> was set to <b><font color="dark">12345'&quot;\'\&quot;);|]*{%0d%0a&lt;%00&gt;%bf%27'#??#</font></b><br/>Error message found: <pre wrap="virtual"><font color="blue">You have an error in your SQL syntax</font></pre>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[uuname]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 222
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=pneeoyei&amp;uuname=12345'&quot;\'\&quot;);|]*{%0d%0a&lt;%00&gt;%bf%27'####]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:49 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 581
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="35" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uaddress</font></b> was set to <b><font color="dark">3137%20Laguna%20Street'&quot;()&amp;%&lt;ScRiPt &gt;prompt(927019)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[uaddress]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 241
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%2520Laguna%2520Street'%22()%26%25&lt;ScRiPt%20&gt;prompt(927019)&lt;/ScRiPt&gt;&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=ggyqaufk&amp;uuname=ggyqaufk]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:51 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 847
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="36" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">ucc</font></b> was set to <b><font color="dark">4111111111111111'&quot;()&amp;%&lt;ScRiPt &gt;prompt(915819)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[ucc]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 237
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111'%22()%26%25&lt;ScRiPt%20&gt;prompt(915819)&lt;/ScRiPt&gt;&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=aqpodpev&amp;uuname=aqpodpev]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:52 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 843
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="37" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uemail</font></b> was set to <b><font color="dark">sample%40email.tst'&quot;()&amp;%&lt;ScRiPt &gt;prompt(917869)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[uemail]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 239
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%2540email.tst'%22()%26%25&lt;ScRiPt%20&gt;prompt(917869)&lt;/ScRiPt&gt;&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=ujihdcfh&amp;uuname=ujihdcfh]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:52 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 845
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="38" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uphone</font></b> was set to <b><font color="dark">555-666-0606'&quot;()&amp;%&lt;ScRiPt &gt;prompt(905557)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[uphone]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 237
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606'%22()%26%25&lt;ScRiPt%20&gt;prompt(905557)&lt;/ScRiPt&gt;&amp;urname=ytbbbavk&amp;uuname=ytbbbavk]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:55 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 843
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="39" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">urname</font></b> was set to <b><font color="dark">ytbbbavk'&quot;()&amp;%&lt;ScRiPt &gt;prompt(939112)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[urname]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 237
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=ytbbbavk'%22()%26%25&lt;ScRiPt%20&gt;prompt(939112)&lt;/ScRiPt&gt;&amp;uuname=rpxsyvww]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:55 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 843
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="40" color="red">
        <Name><![CDATA[CRLF injection/HTTP response splitting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (CRLF_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">r</font></b> was set to <b><font color="dark">ACUSTART
ACUEND</font></b>]]></Details>
        <Affects><![CDATA[/redir.php]]></Affects>
        <Parameter><![CDATA[r]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//redir.php]]></AOP_SourceFile>
        <AOP_SourceLine>3</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Is it possible for a remote attacker to inject custom HTTP headers. For example, an attacker can inject session cookies or HTML code. This may conduct to vulnerabilities like XSS (cross-site scripting) or session fixation. ]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to CRLF injection attacks. <br/><br/>HTTP headers have the structure &quot;Key: Value&quot;, where each line is separated by the CRLF combination. If the user input is injected into the value section without properly escaping/removing CRLF characters it is possible to alter the HTTP headers structure.<br/>
HTTP Response Splitting is a new application attack technique which enables various new attacks such as web cache poisoning, cross user defacement, hijacking pages with sensitive user information and cross-site scripting (XSS). The attacker sends a single HTTP request that forces the web server to form an output stream, which is then interpreted by the target as two HTTP responses instead of one response. ]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[You need to restrict CR(0x13) and LF(0x10) from the user input or properly encode the output in order to prevent the injection of custom HTTP headers. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /redir.php?r=ACUSTART%0d%0aACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:55 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 141
]]></Response>
        </TechnicalDetails>
        <CWE id="113"><![CDATA[CWE-113]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix CRLF Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/crlf-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Whitepaper -  HTTP Response Splitting]]></Database>
            <URL><![CDATA[http://packetstormsecurity.org/papers/general/whitepaper_httpresponse.pdf]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Introduction to HTTP Response Splitting]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5WP0E2KFGK.html]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="41" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uuname</font></b> was set to <b><font color="dark">rpxsyvww'&quot;()&amp;%&lt;ScRiPt &gt;prompt(981469)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[uuname]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 237
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=iiphqlwl&amp;uuname=rpxsyvww'%22()%26%25&lt;ScRiPt%20&gt;prompt(981469)&lt;/ScRiPt&gt;]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:55 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 605
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="42" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uuname</font></b> was set to <b><font color="dark">1ACUSTART'&quot;VfFd7ACUEND</font></b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[uuname]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//secured/newuser.php]]></AOP_SourceFile>
        <AOP_SourceLine>16</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;VfFd7ACUEND'
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 207
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=inrbcvxp&amp;uuname=1ACUSTART'%22VfFd7ACUEND]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:56 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 421
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="43" color="orange">
        <Name><![CDATA[URL redirection]]></Name>
        <ModuleName><![CDATA[Scripting (XFS_and_Redir.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">r</font></b> was set to <b><font color="dark">http://www.vulnweb.com</font></b>]]></Details>
        <Affects><![CDATA[/redir.php]]></Affects>
        <Parameter><![CDATA[r]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[A remote attacker can redirect users from your website to a specified URL. This problem may assist an attacker to conduct phishing attacks, trojan distribution, spammers.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to URL redirection attacks. <br/><br/>URL redirection is sometimes used as a part of phishing attacks that confuse visitors about which web site they are visiting.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should properly sanitize user input. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /redir.php?r=http://www.vulnweb.com HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 302 Moved Temporarily
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:30:58 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Location: http://www.vulnweb.com
Content-Length: 0
]]></Response>
        </TechnicalDetails>
        <CWE id="601"><![CDATA[CWE-601]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:P/A:N]]></Descriptor>
          <Score><![CDATA[6.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[URL Redirection Security Vulnerability]]></Database>
            <URL><![CDATA[http://www.acunetix.com/vulnerabilities/url-redirection/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics]]></Database>
            <URL><![CDATA[http://packetstormsecurity.org/papers/general/whitepaper_httpresponse.pdf]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="44" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">name</font></b> was set to <b><font color="dark">anonymous%20user'&quot;()&amp;%&lt;ScRiPt &gt;prompt(924103)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[name]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /guestbook.php HTTP/1.1
Content-Length: 97
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

name=anonymous%2520user'%22()%26%25&lt;ScRiPt%20&gt;prompt(924103)&lt;/ScRiPt&gt;&amp;submit=add%20message&amp;text=1]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:05 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4586
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="45" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">text</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(982447)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[text]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /guestbook.php HTTP/1.1
Content-Length: 95
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

name=anonymous%20user&amp;submit=add%20message&amp;text=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(982447)&lt;/ScRiPt&gt;]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:06 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4584
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="46" color="red">
        <Name><![CDATA[Directory traversal (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Traversal.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark">1ACUSTARTFILE/../../xxx\..\..\ACUENDFILE</font></b>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//showimage.php]]></AOP_SourceFile>
        <AOP_SourceLine>7</AOP_SourceLine>
        <AOP_Additional><![CDATA[File: 1ACUSTARTFILE/../../xxx\..\..\ACUENDFILE
&quot;fopen&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[By exploiting directory traversal vulnerabilities, attackers step out of the root directory and access files in other directories. As a result, attackers might view restricted files or execute commands, leading to a full compromise of the Web server.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to directory traversal attacks.<br/><br/>Directory Traversal is a vulnerability which allows attackers to access restricted directories and execute commands outside of the web server's root directory.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=1ACUSTARTFILE/../../xxx%5c..%5c..%5cACUENDFILE HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:16 GMT
Content-Type: image/jpeg
Content-Length: 138
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="22"><![CDATA[CWE-22]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Directory Traversal Attacks]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/directory-traversal.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="47" color="red">
        <Name><![CDATA[Script source code disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Script_Source_Code_Disclosure.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark">showimage.php</font></b><br/>Source disclosure pattern found: <pre wrap="virtual"><font color="blue">&lt;?php
// header(&quot;Content-Length: 1&quot; /*. filesize($name)*/);
if( isset($_GET[&quot;file&quot;]) &amp;&amp; !isset($_GET[&quot;size&quot;]) ){
	// open the file in a binary mode
	header(&quot;Content-Type: image/jpeg&quot;);
	$name = $_GET[&quot;file&quot;];
	$fp = fopen($name, 'rb');
	
	// send the right headers
	header(&quot;Content-Type: image/jpeg&quot;);	
	
	// dump the picture and stop the script
	fpassthru($fp);
	exit;
}
elseif (isset($_GET[&quot;file&quot;]) &amp;&amp; isset($_GET[&quot;size&quot;])){
	header(&quot;Content-Type: image/jpeg&quot;);
	$name = $_GET[&quot;file&quot;];
	$fp = fopen($name.'.tn', 'rb');
	
	// send the right headers
	header(&quot;Content-Type: image/jpeg&quot;);	
	
	// dump the picture and stop the script
	fpassthru($fp);
	exit;
}
?&gt; </font></pre>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker can gather sensitive information (database connection strings, application logic) by analyzing the source code. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[It is possible to read the source code of this script by using script filename as a parameter. It seems that this script includes a file which name is determined using user-supplied data. This data is not properly validated before being passed to the include function. ]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Analyze the source code of this script and solve the problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=showimage.php HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:18 GMT
Content-Type: image/jpeg
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 687
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Source Code Disclosure Can Be Exploited On Your Website]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/website-source-code-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="48" color="red">
        <Name><![CDATA[Cross site scripting]]></Name>
        <ModuleName><![CDATA[Scripting (Remote_File_Inclusion_XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark">http://testasp.vulnweb.com/t/xss.html?%00.jpg</font></b>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=http://testasp.vulnweb.com/t/xss.html%3f%2500.jpg HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:18 GMT
Content-Type: image/jpeg
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 33
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="49" color="red">
        <Name><![CDATA[Server side request forgery]]></Name>
        <ModuleName><![CDATA[Scripting (Server_Side_Request_Forgery.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark">http://hitMxFLKYzymC.bxss.me/</font></b><br/><br/>An HTTP request was initiated for the domain <b>hitMxFLKYzymC.bxss.me </b> which indicates that this script is vulnerable to SSRF (Server Side Request Forgery).<br/><br/>HTTP request details: <br/><pre wrap="virtual">IP address: 176.28.50.165
User agent: </pre>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[The impact varies according to the affected server interface.]]></Impact>
        <Description><![CDATA[SSRF as in Server Side Request Forgery is a vulnerability that allows an attacker to force server interfaces into sending packets initiated by the victim server to the local interface or to another server behind the firewall. Consult Web References for more information about this problem.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should properly sanitize user input. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=http://hitMxFLKYzymC.bxss.me/ HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:18 GMT
Content-Type: image/jpeg
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 1891
]]></Response>
        </TechnicalDetails>
        <CWE id="918"><![CDATA[CWE-918]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:N]]></Descriptor>
          <Score><![CDATA[5.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[SSRF VS. BUSINESS-CRITICAL APPLICATIONS]]></Database>
            <URL><![CDATA[https://media.blackhat.com/bh-us-12/Briefings/Polyakov/BH_US_12_Polyakov_SSRF_Business_Slides.pdf]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="50" color="red">
        <Name><![CDATA[Directory traversal (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Traversal.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark">1ACUSTARTFILE/../../xxx\..\..\ACUENDFILE</font></b>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//showimage.php]]></AOP_SourceFile>
        <AOP_SourceLine>19</AOP_SourceLine>
        <AOP_Additional><![CDATA[File: 1ACUSTARTFILE/../../xxx\..\..\ACUENDFILE.tn
&quot;fopen&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[By exploiting directory traversal vulnerabilities, attackers step out of the root directory and access files in other directories. As a result, attackers might view restricted files or execute commands, leading to a full compromise of the Web server.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to directory traversal attacks.<br/><br/>Directory Traversal is a vulnerability which allows attackers to access restricted directories and execute commands outside of the web server's root directory.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=1ACUSTARTFILE/../../xxx%5c..%5c..%5cACUENDFILE&amp;size=160 HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:25 GMT
Content-Type: image/jpeg
Content-Length: 138
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="22"><![CDATA[CWE-22]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Directory Traversal Attacks]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/directory-traversal.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="51" color="orange">
        <Name><![CDATA[Application error message]]></Name>
        <ModuleName><![CDATA[Scripting (Error_Message.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark"></font></b><br/>Error message found: <pre wrap="virtual"><font color="blue">Warning: fopen(): Unable to access .tn in /hj/var/www/showimage.php on line 19

Warning: fopen(.tn): failed to open stream: No such file or directory in /hj/var/www/showimage.php on line 19</font></pre>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=&amp;size=160 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:27 GMT
Content-Type: image/jpeg
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 303
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="52" color="red">
        <Name><![CDATA[Cross site scripting]]></Name>
        <ModuleName><![CDATA[Scripting (Remote_File_Inclusion_XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark">http://testasp.vulnweb.com/t/xss.html?%00.jpg</font></b>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=http://testasp.vulnweb.com/t/xss.html%3f%2500.jpg&amp;size=160 HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:35 GMT
Content-Type: image/jpeg
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 33
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="53" color="red">
        <Name><![CDATA[Server side request forgery]]></Name>
        <ModuleName><![CDATA[Scripting (Server_Side_Request_Forgery.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">file</font></b> was set to <b><font color="dark">http://hit9tBgJJo4i5.bxss.me/</font></b><br/><br/>An HTTP request was initiated for the domain <b>hit9tBgJJo4i5.bxss.me </b> which indicates that this script is vulnerable to SSRF (Server Side Request Forgery).<br/><br/>HTTP request details: <br/><pre wrap="virtual">IP address: 176.28.50.165
User agent: </pre>]]></Details>
        <Affects><![CDATA[/showimage.php]]></Affects>
        <Parameter><![CDATA[file]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[The impact varies according to the affected server interface.]]></Impact>
        <Description><![CDATA[SSRF as in Server Side Request Forgery is a vulnerability that allows an attacker to force server interfaces into sending packets initiated by the victim server to the local interface or to another server behind the firewall. Consult Web References for more information about this problem.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should properly sanitize user input. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /showimage.php?file=http://hit9tBgJJo4i5.bxss.me/&amp;size=160 HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:41 GMT
Content-Type: image/jpeg
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 1891
]]></Response>
        </TechnicalDetails>
        <CWE id="918"><![CDATA[CWE-918]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:N]]></Descriptor>
          <Score><![CDATA[5.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[SSRF VS. BUSINESS-CRITICAL APPLICATIONS]]></Database>
            <URL><![CDATA[https://media.blackhat.com/bh-us-12/Briefings/Polyakov/BH_US_12_Polyakov_SSRF_Business_Slides.pdf]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="54" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uuname</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000438=000438 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+438-438-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+438-438-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+438-438) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+438-438) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000438=000438 --  =&gt; <b>TRUE</b></li><li>-1' OR 000438=000438 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000438=000438 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000438=000438 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000438=000438 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000438=000438 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>ybhqxqyl</b>]]></Details>
        <Affects><![CDATA[/secured/newuser.php]]></Affects>
        <Parameter><![CDATA[uuname]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /secured/newuser.php HTTP/1.1
Content-Length: 235
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

signup=signup&amp;uaddress=3137%20Laguna%20Street&amp;ucc=4111111111111111&amp;uemail=sample%40email.tst&amp;upass=g00dPa%24%24w0rD&amp;upass2=g00dPa%24%24w0rD&amp;uphone=555-666-0606&amp;urname=ybhqxqyl&amp;uuname=-1'%20OR%203*2*1%3d6%20AND%20000438%3d000438%20--%20]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:31:53 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 536
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="55" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">name</font></b> was set to <b><font color="dark">&lt;your%20name%20here&gt;'&quot;()&amp;%&lt;ScRiPt &gt;prompt(971171)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/comment.php]]></Affects>
        <Parameter><![CDATA[name]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /comment.php HTTP/1.1
Content-Length: 139
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

comment=1&amp;name=&lt;your%2520name%2520here&gt;'%22()%26%25&lt;ScRiPt%20&gt;prompt(971171)&lt;/ScRiPt&gt;&amp;phpaction=echo%20%24_POST%5bcomment%5d;&amp;Submit=Submit]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:03 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 649
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="56" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">cart_id</font></b> was set to <b><font color="dark">1ACUSTART'&quot;0sSzFACUEND</font></b>]]></Details>
        <Affects><![CDATA[/sendcommand.php]]></Affects>
        <Parameter><![CDATA[cart_id]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//sendcommand.php]]></AOP_SourceFile>
        <AOP_SourceLine>17</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: DELETE FROM carts WHERE cart_id='1ACUSTART'&quot;0sSzFACUEND'
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /sendcommand.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 32
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

cart_id=1ACUSTART'%220sSzFACUEND]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:09 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 543
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="57" color="red">
        <Name><![CDATA[HTTP parameter pollution]]></Name>
        <ModuleName><![CDATA[Scripting (HTTP_Parameter_Pollution.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&amp;n943821=v994604</font></b><br/>Parameter precedence: <b><font color="dark">last occurrence</font></b><br/>Affected link: <b><font color="dark">params.php?p=valid&amp;pp=12&amp;n943821=v994604</font></b><br/>Affected parameter: <b><font color="dark">p=valid</font></b>]]></Details>
        <Affects><![CDATA[/hpp/index.php]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[The impact depends on the affected web application. An attacker could <br/>
<ul>
<li>Override existing hardcoded HTTP parameters</li>
<li>Modify the application behaviors</li>
<li>Access and, potentially exploit, uncontrollable variables</li>
<li>Bypass input validation checkpoints and WAFs rules</li>
</ul>]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to HTTP Parameter Pollution attacks.<br/><br/>

HPP attacks consist of injecting encoded query string delimiters into other existing parameters. If the web application does not properly sanitize the user input, a malicious user can compromise the logic of the application to perform either clientside or server-side attacks.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[The application should properly sanitize user input (URL encode) to protect against this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/index.php?pp=12%26n943821%3dv994604 HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:17 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 435
]]></Response>
        </TechnicalDetails>
        <CWE id="88"><![CDATA[CWE-88]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[HTTP Parameter Pollution]]></Database>
            <URL><![CDATA[https://www.owasp.org/images/b/ba/AppsecEU09_CarettoniDiPaola_v0.8.pdf]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="58" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&quot; onmouseover=prompt(978729) bad=&quot;</font></b><br/>The input is reflected inside a tag parameter between double quotes.<br/>]]></Details>
        <Affects><![CDATA[/hpp/index.php]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/index.php?pp=12%22%20onmouseover%3dprompt(978729)%20bad%3d%22 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:22 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 497
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="59" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&quot; onmouseover=prompt(924509) bad=&quot;</font></b><br/>The input is reflected inside a tag parameter between double quotes.<br/>]]></Details>
        <Affects><![CDATA[/hpp/index.php]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/index.php?pp=12%22%20onmouseover%3dprompt(924509)%20bad%3d%22 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:24 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 497
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="60" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&quot; onmouseover=prompt(926772) bad=&quot;</font></b><br/>The input is reflected inside a tag parameter between double quotes.<br/>]]></Details>
        <Affects><![CDATA[/hpp/index.php]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/index.php?pp=12%22%20onmouseover%3dprompt(926772)%20bad%3d%22 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:25 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 497
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="61" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">test</font></b> was set to <b><font color="dark">1ACUSTART'&quot;NidXYACUEND</font></b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[test]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//search.php]]></AOP_SourceFile>
        <AOP_SourceLine>60</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM guestbook WHERE sender='1ACUSTART'&quot;NidXYACUEND';
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=1ACUSTART'%22NidXYACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 22
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

goButton=go&amp;searchFor=]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:31 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 6642
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="62" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">searchFor</font></b> was set to <b><font color="dark">1ACUSTART'&quot;8h7BrACUEND</font></b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[searchFor]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//search.php]]></AOP_SourceFile>
        <AOP_SourceLine>70</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: 
				SELECT a.*, b.aname, b.artist_id, c.cname
				FROM pictures a, artists b, categ c 
				WHERE a.cat_id=c.cat_id AND a.a_id=b.artist_id AND (LOCATE('1ACUSTART'&quot;8h7BrACUEND', a.title) &gt; 0 OR LOCATE('1ACUSTART'&quot;8h7BrACUEND', a.pshort) &gt; 0)
			
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=query HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 46
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

goButton=go&amp;searchFor=1ACUSTART'%228h7BrACUEND]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3923
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="63" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">cart_id</font></b> was set to <b><font color="dark">(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/</font></b><br/><br/>Tests performed: <ul><li>(select(0)from(select(sleep(3)))v)/*'+(select(0)from(select(sleep(3)))v)+'&quot;+(select(0)from(select(sleep(3)))v)+&quot;*/ =&gt; <b>3.323 s</b></li><li>(select(0)from(select(sleep(9)))v)/*'+(select(0)from(select(sleep(9)))v)+'&quot;+(select(0)from(select(sleep(9)))v)+&quot;*/ =&gt; <b>9.297 s</b></li><li>(select(0)from(select(sleep(6)))v)/*'+(select(0)from(select(sleep(6)))v)+'&quot;+(select(0)from(select(sleep(6)))v)+&quot;*/ =&gt; <b>6.365 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.468 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.375 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.359 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.28 s</b></li><li>(select(0)from(select(sleep(6)))v)/*'+(select(0)from(select(sleep(6)))v)+'&quot;+(select(0)from(select(sleep(6)))v)+&quot;*/ =&gt; <b>6.396 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.359 s</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/sendcommand.php]]></Affects>
        <Parameter><![CDATA[cart_id]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /sendcommand.php HTTP/1.1
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

cart_id=(select(0)from(select(sleep(0)))v)/*'%2b(select(0)from(select(sleep(0)))v)%2b'%22%2b(select(0)from(select(sleep(0)))v)%2b%22*/]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 543
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="64" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">searchFor</font></b> was set to <b><font color="dark">the'&quot;()&amp;%&lt;ScRiPt &gt;prompt(905385)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[searchFor]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=query HTTP/1.1
Content-Length: 71
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

goButton=go&amp;searchFor=the'%22()%26%25&lt;ScRiPt%20&gt;prompt(905385)&lt;/ScRiPt&gt;]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:39 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3942
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="65" color="orange">
        <Name><![CDATA[Application error message]]></Name>
        <ModuleName><![CDATA[Scripting (Error_Message.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark"></font></b><br/>Error message found: <pre wrap="virtual"><font color="blue">You have an error in your SQL syntax</font></pre>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist=1&amp;cat= HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:45 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4106
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="66" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">test</font></b> was set to <b><font color="dark">(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/</font></b><br/><br/>Tests performed: <ul><li>(select(0)from(select(sleep(6)))v)/*'+(select(0)from(select(sleep(6)))v)+'&quot;+(select(0)from(select(sleep(6)))v)+&quot;*/ =&gt; <b>6.381 s</b></li><li>(select(0)from(select(sleep(3)))v)/*'+(select(0)from(select(sleep(3)))v)+'&quot;+(select(0)from(select(sleep(3)))v)+&quot;*/ =&gt; <b>3.463 s</b></li><li>(select(0)from(select(sleep(9)))v)/*'+(select(0)from(select(sleep(9)))v)+'&quot;+(select(0)from(select(sleep(9)))v)+&quot;*/ =&gt; <b>9.516 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.515 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.312 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.281 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.343 s</b></li><li>(select(0)from(select(sleep(6)))v)/*'+(select(0)from(select(sleep(6)))v)+'&quot;+(select(0)from(select(sleep(6)))v)+&quot;*/ =&gt; <b>6.302 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.296 s</b></li></ul><br/> Original value: <b>query</b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[test]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=(select(0)from(select(sleep(0)))v)/*'%2b(select(0)from(select(sleep(0)))v)%2b'%22%2b(select(0)from(select(sleep(0)))v)%2b%22*/ HTTP/1.1
Content-Length: 22
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

goButton=go&amp;searchFor=]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:50 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 6498
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="67" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark">1ACUSTART'&quot;ZLilOACUEND</font></b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//listproducts.php]]></AOP_SourceFile>
        <AOP_SourceLine>61</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT a.*, b.aname, b.artist_id, c.cname FROM pictures a, artists b, categ c WHERE a.cat_id=c.cat_id AND a.a_id=b.artist_id AND a.cat_id=1ACUSTART'&quot;ZLilOACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist=1&amp;cat=1ACUSTART'%22ZLilOACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:51 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3987
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="68" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(933454)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist=1&amp;cat=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(933454)&lt;/ScRiPt&gt; HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:52 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4144
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="69" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">pass</font></b> was set to <b><font color="dark">1ACUSTART'&quot;0PLrEACUEND</font></b>]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[pass]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//userinfo.php]]></AOP_SourceFile>
        <AOP_SourceLine>8</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='dyaqjnjk' AND pass='1ACUSTART'&quot;0PLrEACUEND'
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /userinfo.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 44
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

pass=1ACUSTART'%220PLrEACUEND&amp;uname=dyaqjnjk]]></Request>
          <Response><![CDATA[HTTP/1.1 302 Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:58 GMT
Content-Type: text/html
Content-Length: 159
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Location: login.php
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="70" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uname</font></b> was set to <b><font color="dark">1ACUSTART'&quot;tKsILACUEND</font></b>]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[uname]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//userinfo.php]]></AOP_SourceFile>
        <AOP_SourceLine>8</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;tKsILACUEND' AND pass='g00dPa$$w0rD'
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /userinfo.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 52
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

pass=g00dPa%24%24w0rD&amp;uname=1ACUSTART'%22tKsILACUEND]]></Request>
          <Response><![CDATA[HTTP/1.1 302 Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:58 GMT
Content-Type: text/html
Content-Length: 159
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Location: login.php
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="71" color="blue">
        <Name><![CDATA[Login page password-guessing attack]]></Name>
        <ModuleName><![CDATA[Scripting (Html_Authentication_Audit.script)]]></ModuleName>
        <Details><![CDATA[The scanner tested 10 invalid credentials and no account lockout was detected.]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may attempt to discover a weak password by systematically trying every possible combination of letters, numbers, and symbols until it discovers the one correct combination that works.]]></Impact>
        <Description><![CDATA[A common threat web developers face is a password-guessing attack known as a brute force attack. A brute-force attack is an attempt to discover a password by systematically trying every possible combination of letters, numbers, and symbols until you discover the one correct combination that works. <br/><br/>

This login page doesn't have any protection against password-guessing attacks (brute force attacks). It's recommended to implement some type of account lockout after a defined number of incorrect password attempts. Consult Web references for more information about fixing this problem. ]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[It's recommended to implement some type of account lockout after a defined number of incorrect password attempts. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /userinfo.php HTTP/1.1
Content-Length: 28
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

pass=knNqnHxa&amp;uname=scKwAWVC]]></Request>
          <Response><![CDATA[HTTP/1.1 302 Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:32:59 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Location: login.php
Content-Length: 14
]]></Response>
        </TechnicalDetails>
        <CWE id="307"><![CDATA[CWE-307]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Blocking Brute Force Attacks]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Blocking_Brute_Force_Attacks]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="72" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark">1 AND 3*2*1=6 AND 589=589</font></b><br/><br/>Tests performed: <ul><li>0+0+0+1 =&gt; <b>TRUE</b></li><li>0+589*584+1 =&gt; <b>FALSE</b></li><li>11-5-2-999 =&gt; <b>FALSE</b></li><li>11-5-2-3 =&gt; <b>TRUE</b></li><li>11-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>11-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>1 AND 2+1-1-1=1 AND 589=589 =&gt; <b>TRUE</b></li><li>1 AND 3+1-1-1=1 AND 589=589 =&gt; <b>FALSE</b></li><li>1 AND 3*2=5 AND 589=589 =&gt; <b>FALSE</b></li><li>1 AND 3*2=6 AND 589=589 =&gt; <b>TRUE</b></li><li>1 AND 3*2*0=6 AND 589=589 =&gt; <b>FALSE</b></li><li>1 AND 3*2*1=6 AND 589=589 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist=1&amp;cat=1%20AND%203*2*1%3d6%20AND%20589%3d589 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:33:01 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 7011
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="73" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">pass</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000465=000465 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+465-465-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+465-465-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+465-465) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+465-465) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000465=000465 --  =&gt; <b>TRUE</b></li><li>-1' OR 000465=000465 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000465=000465 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000465=000465 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000465=000465 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000465=000465 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>g00dPa%24%24w0rD</b>]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[pass]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /userinfo.php HTTP/1.1
Content-Length: 72
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

pass=-1'%20OR%203*2*1%3d6%20AND%20000465%3d000465%20--%20&amp;uname=gosipvld]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:33:03 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Set-Cookie: login=test%2Ftest
Original-Content-Encoding: gzip
Content-Length: 5111
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="74" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">uname</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000187=000187 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+187-187-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+187-187-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+187-187) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+187-187) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000187=000187 --  =&gt; <b>TRUE</b></li><li>-1' OR 000187=000187 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000187=000187 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000187=000187 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000187=000187 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000187=000187 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>gosipvld</b>]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[uname]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /userinfo.php HTTP/1.1
Content-Length: 80
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

pass=g00dPa%24%24w0rD&amp;uname=-1'%20OR%203*2*1%3d6%20AND%20000187%3d000187%20--%20]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:33:13 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Set-Cookie: login=test%2Ftest
Original-Content-Encoding: gzip
Content-Length: 5111
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="75" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1ACUSTART'&quot;Mfn2MACUEND</font></b>]]></Details>
        <Affects><![CDATA[/AJAX/infoartist.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//AJAX/infoartist.php]]></AOP_SourceFile>
        <AOP_SourceLine>5</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM artists WHERE artist_id=1ACUSTART'&quot;Mfn2MACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/infoartist.php?id=1ACUSTART'%22Mfn2MACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:33:24 GMT
Content-Type: text/xml
Content-Length: 175
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="76" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">3 AND 3*2*1=6 AND 217=217</font></b><br/><br/>Tests performed: <ul><li>0+0+0+3 =&gt; <b>TRUE</b></li><li>0+217*212+3 =&gt; <b>FALSE</b></li><li>13-5-2-999 =&gt; <b>FALSE</b></li><li>13-5-2-3 =&gt; <b>TRUE</b></li><li>13-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>13-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>3 AND 2+1-1-1=1 AND 217=217 =&gt; <b>TRUE</b></li><li>3 AND 3+1-1-1=1 AND 217=217 =&gt; <b>FALSE</b></li><li>3 AND 3*2=5 AND 217=217 =&gt; <b>FALSE</b></li><li>3 AND 3*2=6 AND 217=217 =&gt; <b>TRUE</b></li><li>3 AND 3*2*0=6 AND 217=217 =&gt; <b>FALSE</b></li><li>3 AND 3*2*1=6 AND 217=217 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>3</b>]]></Details>
        <Affects><![CDATA[/AJAX/infoartist.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/infoartist.php?id=3%20AND%203*2*1%3d6%20AND%20217%3d217 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:33:31 GMT
Content-Type: text/xml
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 1285
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="77" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">searchFor</font></b> was set to <b><font color="dark">if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/</font></b><br/><br/>Tests performed: <ul><li>if(now()=sysdate(),sleep(3),0)/*'XOR(if(now()=sysdate(),sleep(3),0))OR'&quot;XOR(if(now()=sysdate(),sleep(3),0))OR&quot;*/ =&gt; <b>3.307 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.343 s</b></li><li>if(now()=sysdate(),sleep(9),0)/*'XOR(if(now()=sysdate(),sleep(9),0))OR'&quot;XOR(if(now()=sysdate(),sleep(9),0))OR&quot;*/ =&gt; <b>9.329 s</b></li><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.381 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.436 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.422 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.39 s</b></li><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.318 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.39 s</b></li></ul><br/> Original value: <b>the</b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[searchFor]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=query HTTP/1.1
Content-Length: 156
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

goButton=go&amp;searchFor=if(now()%3dsysdate()%2csleep(0)%2c0)/*'XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR%22*/]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:33:34 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4013
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="78" color="red">
        <Name><![CDATA[Weak password]]></Name>
        <ModuleName><![CDATA[Scripting (Html_Authentication_Audit.script)]]></ModuleName>
        <Details><![CDATA[Username: <b><font color="dark">test</font></b>, Password: <b><font color="dark">test</font></b>]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[An attacker may access the contents of the password-protected page.]]></Impact>
        <Description><![CDATA[ <div class="coolbox"><font color="dark">Manual confirmation is required for this alert.</font></div><br/>This page is using a weak password. Acunetix WVS was able to guess the credentials required to access this page. A weak password is short, common, a system default, or something that could be rapidly guessed by executing a brute force attack using a subset of all possible passwords, such as words in the dictionary, proper names, words based on the user name or common variations on these themes.
]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Enforce a strong password policy. Don't permit weak passwords or passwords based on dictionary words.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /userinfo.php HTTP/1.1
Content-Length: 20
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

pass=test&amp;uname=test]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:33:59 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Set-Cookie: login=test%2Ftest
Original-Content-Encoding: gzip
Content-Length: 5111
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[7.5]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Wikipedia - Password strength]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Password_strength]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Authentication Hacking Attacks]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/authentication.htm]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="79" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">artist</font></b> was set to <b><font color="dark">1ACUSTART'&quot;i4phyACUEND</font></b>]]></Details>
        <Affects><![CDATA[/artists.php]]></Affects>
        <Parameter><![CDATA[artist]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//artists.php]]></AOP_SourceFile>
        <AOP_SourceLine>61</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM artists WHERE artist_id=1ACUSTART'&quot;i4phyACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /artists.php?artist=1ACUSTART'%22i4phyACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:10 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4013
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="80" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">artist</font></b> was set to <b><font color="dark">3 AND 3*2*1=6 AND 897=897</font></b><br/><br/>Tests performed: <ul><li>0+0+0+3 =&gt; <b>TRUE</b></li><li>0+897*892+3 =&gt; <b>FALSE</b></li><li>13-5-2-999 =&gt; <b>FALSE</b></li><li>13-5-2-3 =&gt; <b>TRUE</b></li><li>13-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>13-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>3 AND 2+1-1-1=1 AND 897=897 =&gt; <b>TRUE</b></li><li>3 AND 3+1-1-1=1 AND 897=897 =&gt; <b>FALSE</b></li><li>3 AND 3*2=5 AND 897=897 =&gt; <b>FALSE</b></li><li>3 AND 3*2=6 AND 897=897 =&gt; <b>TRUE</b></li><li>3 AND 3*2*0=6 AND 897=897 =&gt; <b>FALSE</b></li><li>3 AND 3*2*1=6 AND 897=897 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>3</b>]]></Details>
        <Affects><![CDATA[/artists.php]]></Affects>
        <Parameter><![CDATA[artist]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /artists.php?artist=3%20AND%203*2*1%3d6%20AND%20897%3d897 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:19 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5326
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="81" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">p</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(997596)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/hpp/params.php]]></Affects>
        <Parameter><![CDATA[p]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/params.php?aaaa/=1&amp;p=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(997596)&lt;/ScRiPt&gt;&amp;pp=1 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:33 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 40
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="82" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(922289)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/hpp/params.php]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/params.php?aaaa/=1&amp;p=1&amp;pp=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(922289)&lt;/ScRiPt&gt; HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:33 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 40
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="83" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">test</font></b> was set to <b><font color="dark">1ACUSTART'&quot;XfbFzACUEND</font></b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[test]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//search.php]]></AOP_SourceFile>
        <AOP_SourceLine>60</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM guestbook WHERE sender='1ACUSTART'&quot;XfbFzACUEND';
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=1ACUSTART'%22XfbFzACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 11
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

searchFor=1]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:42 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4046
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="84" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">searchFor</font></b> was set to <b><font color="dark">1ACUSTART'&quot;kp9VLACUEND</font></b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[searchFor]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//search.php]]></AOP_SourceFile>
        <AOP_SourceLine>70</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: 
				SELECT a.*, b.aname, b.artist_id, c.cname
				FROM pictures a, artists b, categ c 
				WHERE a.cat_id=c.cat_id AND a.a_id=b.artist_id AND (LOCATE('1ACUSTART'&quot;kp9VLACUEND', a.title) &gt; 0 OR LOCATE('1ACUSTART'&quot;kp9VLACUEND', a.pshort) &gt; 0)
			
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=1 HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 34
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

searchFor=1ACUSTART'%22kp9VLACUEND]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:42 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3923
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="85" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">searchFor</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(920030)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[searchFor]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=1 HTTP/1.1
Content-Length: 57
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

searchFor=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(920030)&lt;/ScRiPt&gt;]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:44 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3940
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="86" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">name</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(938173)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[name]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /guestbook.php HTTP/1.1
Content-Length: 59
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

name=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(938173)&lt;/ScRiPt&gt;&amp;text=1]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:50 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4571
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="87" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">text</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(990802)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[text]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /guestbook.php HTTP/1.1
Content-Length: 59
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

name=1&amp;text=1'%22()%26%25&lt;ScRiPt%20&gt;prompt(990802)&lt;/ScRiPt&gt;]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:50 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4571
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="88" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">id</font></b> was set to <b><font color="dark">1ACUSTART'&quot;0qloSACUEND</font></b>]]></Details>
        <Affects><![CDATA[/AJAX/infotitle.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//AJAX/infotitle.php]]></AOP_SourceFile>
        <AOP_SourceLine>5</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM pictures WHERE pic_id=1ACUSTART'&quot;0qloSACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /AJAX/infotitle.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 27
Content-Type: application/x-www-form-urlencoded
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

id=1ACUSTART'%220qloSACUEND]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:53 GMT
Content-Type: text/xml
Content-Length: 172
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="89" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pic</font></b> was set to <b><font color="dark">1ACUSTART'&quot;FAiFZACUEND</font></b>]]></Details>
        <Affects><![CDATA[/product.php]]></Affects>
        <Parameter><![CDATA[pic]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//product.php]]></AOP_SourceFile>
        <AOP_SourceLine>68</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT a.*, b.aname, b.artist_id, c.cname FROM pictures a, artists b, categ c WHERE a.cat_id=c.cat_id AND a.a_id=b.artist_id AND a.pic_id=1ACUSTART'&quot;FAiFZACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /product.php?pic=1ACUSTART'%22FAiFZACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:57 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4340
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="90" color="orange">
        <Name><![CDATA[Application error message]]></Name>
        <ModuleName><![CDATA[Scripting (Error_Message.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark"></font></b><br/>Error message found: <pre wrap="virtual"><font color="blue">You have an error in your SQL syntax</font></pre>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?cat= HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:34:59 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4106
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="91" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark">1ACUSTART'&quot;lyCW6ACUEND</font></b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//listproducts.php]]></AOP_SourceFile>
        <AOP_SourceLine>61</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT a.*, b.aname, b.artist_id, c.cname FROM pictures a, artists b, categ c WHERE a.cat_id=c.cat_id AND a.a_id=b.artist_id AND a.cat_id=1ACUSTART'&quot;lyCW6ACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?cat=1ACUSTART'%22lyCW6ACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:01 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3987
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="92" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">id</font></b> was set to <b><font color="dark">3 AND 3*2*1=6 AND 587=587</font></b><br/><br/>Tests performed: <ul><li>0+0+0+3 =&gt; <b>TRUE</b></li><li>0+587*582+3 =&gt; <b>FALSE</b></li><li>13-5-2-999 =&gt; <b>FALSE</b></li><li>13-5-2-3 =&gt; <b>TRUE</b></li><li>13-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>13-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>3 AND 2+1-1-1=1 AND 587=587 =&gt; <b>TRUE</b></li><li>3 AND 3+1-1-1=1 AND 587=587 =&gt; <b>FALSE</b></li><li>3 AND 3*2=5 AND 587=587 =&gt; <b>FALSE</b></li><li>3 AND 3*2=6 AND 587=587 =&gt; <b>TRUE</b></li><li>3 AND 3*2*0=6 AND 587=587 =&gt; <b>FALSE</b></li><li>3 AND 3*2*1=6 AND 587=587 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>3</b>]]></Details>
        <Affects><![CDATA[/AJAX/infotitle.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /AJAX/infotitle.php HTTP/1.1
Content-Length: 40
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

id=3%20AND%203*2*1%3d6%20AND%20587%3d587]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:01 GMT
Content-Type: text/xml
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 885
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="93" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark">4'&quot;()&amp;%&lt;ScRiPt &gt;prompt(934181)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?cat=4'%22()%26%25&lt;ScRiPt%20&gt;prompt(934181)&lt;/ScRiPt&gt; HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:01 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4144
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="94" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pic</font></b> was set to <b><font color="dark">4 AND 3*2*1=6 AND 77=77</font></b><br/><br/>Tests performed: <ul><li>0+0+0+4 =&gt; <b>TRUE</b></li><li>0+77*72+4 =&gt; <b>FALSE</b></li><li>14-5-2-999 =&gt; <b>FALSE</b></li><li>14-5-2-3 =&gt; <b>TRUE</b></li><li>14-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>14-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>4 AND 2+1-1-1=1 AND 77=77 =&gt; <b>TRUE</b></li><li>4 AND 3+1-1-1=1 AND 77=77 =&gt; <b>FALSE</b></li><li>4 AND 3*2=5 AND 77=77 =&gt; <b>FALSE</b></li><li>4 AND 3*2=6 AND 77=77 =&gt; <b>TRUE</b></li><li>4 AND 3*2*0=6 AND 77=77 =&gt; <b>FALSE</b></li><li>4 AND 3*2*1=6 AND 77=77 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>4</b>]]></Details>
        <Affects><![CDATA[/product.php]]></Affects>
        <Parameter><![CDATA[pic]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /product.php?pic=4%20AND%203*2*1%3d6%20AND%2077%3d77 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:05 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5592
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="95" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">test</font></b> was set to <b><font color="dark">(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/</font></b><br/><br/>Tests performed: <ul><li>(select(0)from(select(sleep(9)))v)/*'+(select(0)from(select(sleep(9)))v)+'&quot;+(select(0)from(select(sleep(9)))v)+&quot;*/ =&gt; <b>9.344 s</b></li><li>(select(0)from(select(sleep(3)))v)/*'+(select(0)from(select(sleep(3)))v)+'&quot;+(select(0)from(select(sleep(3)))v)+&quot;*/ =&gt; <b>3.401 s</b></li><li>(select(0)from(select(sleep(6)))v)/*'+(select(0)from(select(sleep(6)))v)+'&quot;+(select(0)from(select(sleep(6)))v)+&quot;*/ =&gt; <b>6.302 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.406 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.406 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.266 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.468 s</b></li><li>(select(0)from(select(sleep(6)))v)/*'+(select(0)from(select(sleep(6)))v)+'&quot;+(select(0)from(select(sleep(6)))v)+&quot;*/ =&gt; <b>6.396 s</b></li><li>(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'&quot;+(select(0)from(select(sleep(0)))v)+&quot;*/ =&gt; <b>0.484 s</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[test]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=(select(0)from(select(sleep(0)))v)/*'%2b(select(0)from(select(sleep(0)))v)%2b'%22%2b(select(0)from(select(sleep(0)))v)%2b%22*/ HTTP/1.1
Content-Length: 11
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

searchFor=1]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:07 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3902
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="96" color="red">
        <Name><![CDATA[HTTP parameter pollution]]></Name>
        <ModuleName><![CDATA[Scripting (HTTP_Parameter_Pollution.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&amp;n923615=v923859</font></b><br/>Parameter precedence: <b><font color="dark">last occurrence</font></b><br/>Affected link: <b><font color="dark">params.php?p=valid&amp;pp=12&amp;n923615=v923859</font></b><br/>Affected parameter: <b><font color="dark">p=valid</font></b>]]></Details>
        <Affects><![CDATA[/hpp/]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[The impact depends on the affected web application. An attacker could <br/>
<ul>
<li>Override existing hardcoded HTTP parameters</li>
<li>Modify the application behaviors</li>
<li>Access and, potentially exploit, uncontrollable variables</li>
<li>Bypass input validation checkpoints and WAFs rules</li>
</ul>]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to HTTP Parameter Pollution attacks.<br/><br/>

HPP attacks consist of injecting encoded query string delimiters into other existing parameters. If the web application does not properly sanitize the user input, a malicious user can compromise the logic of the application to perform either clientside or server-side attacks.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[The application should properly sanitize user input (URL encode) to protect against this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/?pp=12%26n923615%3dv923859 HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:08 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 435
]]></Response>
        </TechnicalDetails>
        <CWE id="88"><![CDATA[CWE-88]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[HTTP Parameter Pollution]]></Database>
            <URL><![CDATA[https://www.owasp.org/images/b/ba/AppsecEU09_CarettoniDiPaola_v0.8.pdf]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="97" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&quot; onmouseover=prompt(963789) bad=&quot;</font></b><br/>The input is reflected inside a tag parameter between double quotes.<br/>]]></Details>
        <Affects><![CDATA[/hpp/]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/?pp=12%22%20onmouseover%3dprompt(963789)%20bad%3d%22 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:13 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 497
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="98" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&quot; onmouseover=prompt(938667) bad=&quot;</font></b><br/>The input is reflected inside a tag parameter between double quotes.<br/>]]></Details>
        <Affects><![CDATA[/hpp/]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/?pp=12%22%20onmouseover%3dprompt(938667)%20bad%3d%22 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:14 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 497
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="99" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1ACUSTART'&quot;zCo35ACUEND</font></b>]]></Details>
        <Affects><![CDATA[/AJAX/infocateg.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//AJAX/infocateg.php]]></AOP_SourceFile>
        <AOP_SourceLine>5</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM categ WHERE cat_id=1ACUSTART'&quot;zCo35ACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/infocateg.php?id=1ACUSTART'%22zCo35ACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:16 GMT
Content-Type: text/xml
Content-Length: 172
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="100" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">pp</font></b> was set to <b><font color="dark">12&quot; onmouseover=prompt(917007) bad=&quot;</font></b><br/>The input is reflected inside a tag parameter between double quotes.<br/>]]></Details>
        <Affects><![CDATA[/hpp/]]></Affects>
        <Parameter><![CDATA[pp]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /hpp/?pp=12%22%20onmouseover%3dprompt(917007)%20bad%3d%22 HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:16 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 497
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="101" color="orange">
        <Name><![CDATA[Application error message]]></Name>
        <ModuleName><![CDATA[Scripting (Error_Message.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">artist</font></b> was set to <b><font color="dark"></font></b><br/>Error message found: <pre wrap="virtual"><font color="blue">You have an error in your SQL syntax</font></pre>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[artist]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist= HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:17 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4106
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="102" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">artist</font></b> was set to <b><font color="dark">1ACUSTART'&quot;7ijNSACUEND</font></b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[artist]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//listproducts.php]]></AOP_SourceFile>
        <AOP_SourceLine>67</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT a.*, b.aname, b.artist_id, c.cname FROM pictures a, artists b, categ c WHERE a.cat_id=c.cat_id AND a.a_id=b.artist_id AND a.a_id=1ACUSTART'&quot;7ijNSACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist=1ACUSTART'%227ijNSACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:19 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3987
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="103" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">artist</font></b> was set to <b><font color="dark">3'&quot;()&amp;%&lt;ScRiPt &gt;prompt(955291)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[artist]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist=3'%22()%26%25&lt;ScRiPt%20&gt;prompt(955291)&lt;/ScRiPt&gt; HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:20 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4144
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="104" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">3 AND 3*2*1=6 AND 377=377</font></b><br/><br/>Tests performed: <ul><li>0+0+0+3 =&gt; <b>TRUE</b></li><li>0+377*372+3 =&gt; <b>FALSE</b></li><li>13-5-2-999 =&gt; <b>FALSE</b></li><li>13-5-2-3 =&gt; <b>TRUE</b></li><li>13-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>13-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>3 AND 2+1-1-1=1 AND 377=377 =&gt; <b>TRUE</b></li><li>3 AND 3+1-1-1=1 AND 377=377 =&gt; <b>FALSE</b></li><li>3 AND 3*2=5 AND 377=377 =&gt; <b>FALSE</b></li><li>3 AND 3*2=6 AND 377=377 =&gt; <b>TRUE</b></li><li>3 AND 3*2*0=6 AND 377=377 =&gt; <b>FALSE</b></li><li>3 AND 3*2*1=6 AND 377=377 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>3</b>]]></Details>
        <Affects><![CDATA[/AJAX/infocateg.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/infocateg.php?id=3%20AND%203*2*1%3d6%20AND%20377%3d377 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:22 GMT
Content-Type: text/xml
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Content-Length: 324
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="105" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1ACUSTART'&quot;UojGqACUEND</font></b>]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/rate.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//Mod_Rewrite_Shop/rate.php]]></AOP_SourceFile>
        <AOP_SourceLine>6</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * from products where id=1ACUSTART'&quot;UojGqACUEND
&quot;mysql_query&quot; was called.
Stack trace:
  1. ProcessID([string] &quot;1ACUSTART'&quot;UojGqACUEND&quot;)]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/rate.php?id=1ACUSTART'%22UojGqACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:24 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 164
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="106" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1ACUSTART'&quot;JzYRZACUEND</font></b>]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/details.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//Mod_Rewrite_Shop/details.php]]></AOP_SourceFile>
        <AOP_SourceLine>4</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * from products where id=1ACUSTART'&quot;JzYRZACUEND
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/details.php?id=1ACUSTART'%22JzYRZACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:28 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 208
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="107" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">cat</font></b> was set to <b><font color="dark">if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/</font></b><br/><br/>Tests performed: <ul><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.521 s</b></li><li>if(now()=sysdate(),sleep(9),0)/*'XOR(if(now()=sysdate(),sleep(9),0))OR'&quot;XOR(if(now()=sysdate(),sleep(9),0))OR&quot;*/ =&gt; <b>9.516 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.39 s</b></li><li>if(now()=sysdate(),sleep(3),0)/*'XOR(if(now()=sysdate(),sleep(3),0))OR'&quot;XOR(if(now()=sysdate(),sleep(3),0))OR&quot;*/ =&gt; <b>3.417 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.406 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.374 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.327 s</b></li><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.349 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.328 s</b></li></ul><br/> Original value: <b>4</b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[cat]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?cat=if(now()%3dsysdate()%2csleep(0)%2c0)/*'XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR%22*/ HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:30 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3830
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="108" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1ACUSTART'&quot;ZAtM6ACUEND</font></b>]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/buy.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//Mod_Rewrite_Shop/buy.php]]></AOP_SourceFile>
        <AOP_SourceLine>6</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * from products where id=1ACUSTART'&quot;ZAtM6ACUEND
&quot;mysql_query&quot; was called.
Stack trace:
  1. ProcessID([string] &quot;1ACUSTART'&quot;ZAtM6ACUEND&quot;)]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/buy.php?id=1ACUSTART'%22ZAtM6ACUEND HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:33 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 163
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="109" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1 AND 3*2*1=6 AND 39=39</font></b><br/><br/>Tests performed: <ul><li>0+0+0+1 =&gt; <b>TRUE</b></li><li>0+39*34+1 =&gt; <b>FALSE</b></li><li>11-5-2-999 =&gt; <b>FALSE</b></li><li>11-5-2-3 =&gt; <b>TRUE</b></li><li>11-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>11-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>1 AND 2+1-1-1=1 AND 39=39 =&gt; <b>TRUE</b></li><li>1 AND 3+1-1-1=1 AND 39=39 =&gt; <b>FALSE</b></li><li>1 AND 3*2=5 AND 39=39 =&gt; <b>FALSE</b></li><li>1 AND 3*2=6 AND 39=39 =&gt; <b>TRUE</b></li><li>1 AND 3*2*0=6 AND 39=39 =&gt; <b>FALSE</b></li><li>1 AND 3*2*1=6 AND 39=39 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/rate.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/rate.php?id=1%20AND%203*2*1%3d6%20AND%2039%3d39 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:33 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 100
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="110" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1 AND 3*2*1=6 AND 849=849</font></b><br/><br/>Tests performed: <ul><li>0+0+0+1 =&gt; <b>TRUE</b></li><li>0+849*844+1 =&gt; <b>FALSE</b></li><li>11-5-2-999 =&gt; <b>FALSE</b></li><li>11-5-2-3 =&gt; <b>TRUE</b></li><li>11-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>11-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>1 AND 2+1-1-1=1 AND 849=849 =&gt; <b>TRUE</b></li><li>1 AND 3+1-1-1=1 AND 849=849 =&gt; <b>FALSE</b></li><li>1 AND 3*2=5 AND 849=849 =&gt; <b>FALSE</b></li><li>1 AND 3*2=6 AND 849=849 =&gt; <b>TRUE</b></li><li>1 AND 3*2*0=6 AND 849=849 =&gt; <b>FALSE</b></li><li>1 AND 3*2*1=6 AND 849=849 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/details.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/details.php?id=1%20AND%203*2*1%3d6%20AND%20849%3d849 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:36 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 319
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="111" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">id</font></b> was set to <b><font color="dark">1 AND 3*2*1=6 AND 362=362</font></b><br/><br/>Tests performed: <ul><li>0+0+0+1 =&gt; <b>TRUE</b></li><li>0+362*357+1 =&gt; <b>FALSE</b></li><li>11-5-2-999 =&gt; <b>FALSE</b></li><li>11-5-2-3 =&gt; <b>TRUE</b></li><li>11-2*5+0+0+1-1 =&gt; <b>TRUE</b></li><li>11-2*6+0+0+1-1 =&gt; <b>FALSE</b></li><li>1 AND 2+1-1-1=1 AND 362=362 =&gt; <b>TRUE</b></li><li>1 AND 3+1-1-1=1 AND 362=362 =&gt; <b>FALSE</b></li><li>1 AND 3*2=5 AND 362=362 =&gt; <b>FALSE</b></li><li>1 AND 3*2=6 AND 362=362 =&gt; <b>TRUE</b></li><li>1 AND 3*2*0=6 AND 362=362 =&gt; <b>FALSE</b></li><li>1 AND 3*2*1=6 AND 362=362 =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/buy.php]]></Affects>
        <Parameter><![CDATA[id]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/buy.php?id=1%20AND%203*2*1%3d6%20AND%20362%3d362 HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:40 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 100
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="112" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded POST input <b><font color="dark">searchFor</font></b> was set to <b><font color="dark">if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/</font></b><br/><br/>Tests performed: <ul><li>if(now()=sysdate(),sleep(3),0)/*'XOR(if(now()=sysdate(),sleep(3),0))OR'&quot;XOR(if(now()=sysdate(),sleep(3),0))OR&quot;*/ =&gt; <b>3.338 s</b></li><li>if(now()=sysdate(),sleep(9),0)/*'XOR(if(now()=sysdate(),sleep(9),0))OR'&quot;XOR(if(now()=sysdate(),sleep(9),0))OR&quot;*/ =&gt; <b>9.344 s</b></li><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.365 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.39 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.436 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.53 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.422 s</b></li><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.318 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.374 s</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[searchFor]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[POST /search.php?test=1 HTTP/1.1
Content-Length: 144
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

searchFor=if(now()%3dsysdate()%2csleep(0)%2c0)/*'XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR%22*/]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:42 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4013
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="113" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;IOwNBACUEND</font></b>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//index.php]]></AOP_SourceFile>
        <AOP_SourceLine>46</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;IOwNBACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;IOwNBACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:43 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4277
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="114" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[URL encoded GET input <b><font color="dark">artist</font></b> was set to <b><font color="dark">if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/</font></b><br/><br/>Tests performed: <ul><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.302 s</b></li><li>if(now()=sysdate(),sleep(3),0)/*'XOR(if(now()=sysdate(),sleep(3),0))OR'&quot;XOR(if(now()=sysdate(),sleep(3),0))OR&quot;*/ =&gt; <b>3.323 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.39 s</b></li><li>if(now()=sysdate(),sleep(9),0)/*'XOR(if(now()=sysdate(),sleep(9),0))OR'&quot;XOR(if(now()=sysdate(),sleep(9),0))OR&quot;*/ =&gt; <b>9.407 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.343 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.437 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.343 s</b></li><li>if(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'&quot;XOR(if(now()=sysdate(),sleep(6),0))OR&quot;*/ =&gt; <b>6.396 s</b></li><li>if(now()=sysdate(),sleep(0),0)/*'XOR(if(now()=sysdate(),sleep(0),0))OR'&quot;XOR(if(now()=sysdate(),sleep(0),0))OR&quot;*/ =&gt; <b>0.405 s</b></li></ul><br/> Original value: <b>3</b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[artist]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php?artist=if(now()%3dsysdate()%2csleep(0)%2c0)/*'XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR%22*/ HTTP/1.1
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:48 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3830
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="115" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000213=000213 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+213-213-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+213-213-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+213-213) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+213-213) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000213=000213 --  =&gt; <b>TRUE</b></li><li>-1' OR 000213=000213 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000213=000213 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000213=000213 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000213=000213 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000213=000213 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000213=000213%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:35:49 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4235
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="116" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;2sxjMACUEND</font></b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//search.php]]></AOP_SourceFile>
        <AOP_SourceLine>44</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;2sxjMACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /search.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;2sxjMACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:36:07 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4046
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="117" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000601=000601 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+601-601-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+601-601-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+601-601) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+601-601) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000601=000601 --  =&gt; <b>TRUE</b></li><li>-1' OR 000601=000601 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000601=000601 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000601=000601 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000601=000601 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000601=000601 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /search.php HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000601=000601%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:36:12 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4072
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="118" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;vnlD3ACUEND</font></b>]]></Details>
        <Affects><![CDATA[/cart.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//cart.php]]></AOP_SourceFile>
        <AOP_SourceLine>44</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;vnlD3ACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /cart.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;vnlD3ACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:37:03 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4188
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="119" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000294=000294 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+294-294-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+294-294-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+294-294) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+294-294) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000294=000294 --  =&gt; <b>TRUE</b></li><li>-1' OR 000294=000294 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000294=000294 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000294=000294 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000294=000294 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000294=000294 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/cart.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /cart.php HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000294=000294%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:37:11 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4462
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="120" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;etNhNACUEND</font></b>]]></Details>
        <Affects><![CDATA[/artists.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//artists.php]]></AOP_SourceFile>
        <AOP_SourceLine>44</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;etNhNACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /artists.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;etNhNACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:37:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4644
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="121" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000815=000815 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+815-815-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+815-815-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+815-815) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+815-815) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000815=000815 --  =&gt; <b>TRUE</b></li><li>-1' OR 000815=000815 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000815=000815 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000815=000815 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000815=000815 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000815=000815 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/artists.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /artists.php HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000815=000815%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:37:46 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4602
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="122" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;Jj2BEACUEND</font></b>]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//userinfo.php]]></AOP_SourceFile>
        <AOP_SourceLine>46</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;Jj2BEACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /userinfo.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;Jj2BEACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 302 Found
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:38:12 GMT
Content-Type: text/html
Content-Length: 160
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Location: login.php
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="123" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000927=000927 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+927-927-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+927-927-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+927-927) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+927-927) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000927=000927 --  =&gt; <b>TRUE</b></li><li>-1' OR 000927=000927 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000927=000927 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000927=000927 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000927=000927 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000927=000927 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/userinfo.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /userinfo.php HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000927=000927%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:38:14 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5181
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="124" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;uhariACUEND</font></b>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//guestbook.php]]></AOP_SourceFile>
        <AOP_SourceLine>49</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;uhariACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /guestbook.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;uhariACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:38:46 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4724
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="125" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1&quot; onmouseover=prompt(928181) bad=&quot;</font></b><br/>The input is reflected inside a tag parameter between double quotes.<br/>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /guestbook.php HTTP/1.1
Cookie: login=1&quot;%20onmouseover=prompt(928181)%20bad=&quot;
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:38:50 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4801
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="126" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000696=000696 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+696-696-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+696-696-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+696-696) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+696-696) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000696=000696 --  =&gt; <b>TRUE</b></li><li>-1' OR 000696=000696 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000696=000696 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000696=000696 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000696=000696 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000696=000696 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /guestbook.php HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000696=000696%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:38:51 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4838
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="127" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">mycookie</font></b> was set to <b><font color="dark">1'&quot;()&amp;%&lt;ScRiPt &gt;prompt(918917)&lt;/ScRiPt&gt;</font></b>]]></Details>
        <Affects><![CDATA[/AJAX/showxml.php]]></Affects>
        <Parameter><![CDATA[mycookie]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/showxml.php HTTP/1.1
Cookie: mycookie=1'&quot;()&amp;%&lt;ScRiPt%20&gt;prompt(918917)&lt;/ScRiPt&gt;
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:50:58 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 72
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="128" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;PK8haACUEND</font></b>]]></Details>
        <Affects><![CDATA[/product.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//product.php]]></AOP_SourceFile>
        <AOP_SourceLine>51</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;PK8haACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /product.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;PK8haACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:56:31 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4378
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="129" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000634=000634 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+634-634-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+634-634-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+634-634) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+634-634) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000634=000634 --  =&gt; <b>TRUE</b></li><li>-1' OR 000634=000634 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000634=000634 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000634=000634 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000634=000634 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000634=000634 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/product.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /product.php HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000634=000634%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:56:35 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4336
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="130" color="red">
        <Name><![CDATA[SQL injection (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">1ACUSTART'&quot;DZL1aACUEND</font></b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[/hj/var/www//listproducts.php]]></AOP_SourceFile>
        <AOP_SourceLine>43</AOP_SourceLine>
        <AOP_Additional><![CDATA[SQL query: SELECT * FROM users WHERE uname='1ACUSTART'&quot;DZL1aACUEND' AND pass=''
&quot;mysql_query&quot; was called.]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Cookie: login=1ACUSTART'&quot;DZL1aACUEND
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:57:06 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4168
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="131" color="red">
        <Name><![CDATA[Blind SQL Injection]]></Name>
        <ModuleName><![CDATA[Scripting (Blind_Sql_Injection.script)]]></ModuleName>
        <Details><![CDATA[Cookie input <b><font color="dark">login</font></b> was set to <b><font color="dark">-1' OR 3*2*1=6 AND 000480=000480 -- </font></b><br/><br/>Tests performed: <ul><li>-1' OR 2+480-480-1=0+0+0+1 --  =&gt; <b>TRUE</b></li><li>-1' OR 3+480-480-1=0+0+0+1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&lt;(0+5+480-480) --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2&gt;(0+5+480-480) --  =&gt; <b>FALSE</b></li><li>-1' OR 2+1-1-1=1 AND 000480=000480 --  =&gt; <b>TRUE</b></li><li>-1' OR 000480=000480 AND 3+1-1-1=1 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=5 AND 000480=000480 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2=6 AND 000480=000480 --  =&gt; <b>TRUE</b></li><li>-1' OR 3*2*0=6 AND 000480=000480 --  =&gt; <b>FALSE</b></li><li>-1' OR 3*2*1=6 AND 000480=000480 --  =&gt; <b>TRUE</b></li></ul><br/> Original value: <b>1</b>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[login]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker may execute arbitrary SQL statements on the vulnerable system. This may compromise the integrity of your database and/or expose sensitive information. <br/><br/>Depending on the back-end database in use, SQL injection vulnerabilities lead to varying levels of data/system access for the attacker. It may be possible to not only manipulate existing queries, but to UNION in arbitrary data, use sub selects, or append additional queries. In some cases, it may be possible to read in or write out to files, or to execute shell commands on the underlying operating system.<br/><br/>Certain SQL Servers such as Microsoft SQL Server contain stored and extended procedures (database server functions). If an attacker can obtain access to these procedures it may be possible to compromise the entire machine.]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to SQL Injection attacks.<br/><br/>
SQL injection is a vulnerability that allows an attacker to alter back-end SQL statements by manipulating the user input. An SQL injection occurs when web applications accept user input that is directly placed into a SQL statement and doesn't properly filter out dangerous characters. <br/> <br/> This is one of the most common application layer attacks currently being used on the Internet.  Despite the fact that it is relatively easy to protect against, there is a large number of web applications vulnerable.]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from  SQL Injection Attacks by Example - http://www.unixwiz.net/techtips/sql-injection.html</i>
<h2>SQL injection mitigations</h2>

<p>We believe that web application developers often simply do not think about &quot;surprise inputs&quot;, but security people do (including the bad guys), so there are three broad approaches that can be applied here.</p>

<h2>Sanitize the input</h2>
<p>It's absolutely vital to sanitize user inputs to insure that they do not contain dangerous codes, whether to the SQL server or to HTML itself. One's first idea is to strip out &quot;bad stuff&quot;, such as quotes or semicolons or escapes, but this is a misguided attempt. Though it's easy to point out some dangerous characters, it's harder to point to all of them.</p>
<p>The language of the web is full of special characters and strange markup (including alternate ways of representing the same characters), and efforts to authoritatively identify all &quot;bad stuff&quot; are unlikely to be successful.</p>
<p>Instead, rather than &quot;remove known bad data&quot;, it's better to &quot;remove everything but known good data&quot;: this distinction is crucial. Since - in our example - an email address can contain only these characters: </p>
<code><pre wrap="virtual">
    abcdefghijklmnopqrstuvwxyz
    ABCDEFGHIJKLMNOPQRSTUVWXYZ
    0123456789
    @.-_+
</pre></code>

<p>There is really no benefit in allowing characters that could not be valid, and rejecting them early - presumably with an error message - not only helps forestall SQL Injection, but also catches mere typos early rather than stores them into the database. </p>

<p>Be aware that &quot;sanitizing the input&quot; doesn't mean merely &quot;remove the quotes&quot;, because even &quot;regular&quot; characters can be troublesome. In an example where an integer ID value is being compared against the user input (say, a numeric PIN): </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM table
     WHERE id = 23 OR 1=1;  -- Boom! Always matches!
</pre></code>
<p>In practice, however, this approach is highly limited because there are so few fields for which it's possible to outright exclude many of the dangerous characters. For &quot;dates&quot; or &quot;email addresses&quot; or &quot;integers&quot; it may have merit, but for any kind of real application, one simply cannot avoid the other mitigations. </p>

<h2>Escape/Quotesafe the input</h2>
<p>Even if one might be able to sanitize a phone number or email address, one cannot take this approach with a &quot;name&quot; field lest one wishes to exclude the likes of Bill O'Reilly from one's application: a quote is simply a valid character for this field.</p>
<p>One includes an actual single quote in an SQL string by putting two of them together, so this suggests the obvious - but wrong! - technique of preprocessing every string to replicate the single quotes:</p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = 'Bill O''Reilly';  -- works OK
</pre></code>    
<p>However, this naive approach can be beaten because most databases support other string escape mechanisms. MySQL, for instance, also permits \' to escape a quote, so after input of \'; DROP TABLE users; -- is &quot;protected&quot; by doubling the quotes, we get: </p>
<code><pre wrap="virtual">
    SELECT fieldlist
      FROM customers
     WHERE name = '\''; DROP TABLE users; --';  -- Boom!
</pre></code>    
<p>The expression '\'' is a complete string (containing just one single quote), and the usual SQL shenanigans follow. It doesn't stop with backslashes either: there is Unicode, other encodings, and parsing oddities all hiding in the weeds to trip up the application designer.</p>
<p>Getting quotes right is notoriously difficult, which is why many database interface languages provide a function that does it for you. When the same internal code is used for &quot;string quoting&quot; and &quot;string parsing&quot;, it's much more likely that the process will be done properly and safely.</p>
<p>Some examples are the MySQL function <b>mysql_real_escape_string()</b> and perl DBD method <b>$dbh-&gt;quote($value)</b>. These methods must be used. </p>

<h2>Use bound parameters (the PREPARE statement)</h2>
<p>Though quotesafing is a good mechanism, we're still in the area of &quot;considering user input as SQL&quot;, and a much better approach exists: bound parameters, which are supported by essentially all database programming interfaces. In this technique, an SQL statement string is created with placeholders - a question mark for each parameter - and it's compiled (&quot;prepared&quot;, in SQL parlance) into an internal form. Later, this prepared query is &quot;executed&quot; with a list of parameters: </p>

<b>Example in perl</b>
<code><pre wrap="virtual">    $sth = $dbh-&gt;prepare(&quot;SELECT email, userid FROM members WHERE email = ?;&quot;);
    $sth-&gt;execute($email);
</pre></code> 
<p>Thanks to Stefan Wagner, this demonstrates bound parameters in Java: </p>

<b>Insecure version</b>
<code><pre wrap="virtual">    Statement s = connection.createStatement();
    ResultSet rs = s.executeQuery(&quot;SELECT email FROM member WHERE name = &quot;
                                 + formField); // *boom*
</pre></code> 

<p><b>Secure version</b></p>
<code><pre wrap="virtual">    PreparedStatement ps = connection.prepareStatement(
        &quot;SELECT email FROM member WHERE name = ?&quot;);
    ps.setString(1, formField);
    ResultSet rs = ps.executeQuery();
</pre></code> 

<p>Here, $email is the data obtained from the user's form, and it is passed as positional parameter #1 (the first question mark), and at no point do the contents of this variable have anything to do with SQL statement parsing. Quotes, semicolons, backslashes, SQL comment notation - none of this has any impact, because it's &quot;just data&quot;. There simply is nothing to subvert, so the application is be largely immune to SQL injection attacks.</p>
 
<p>There also may be some performance benefits if this prepared query is reused multiple times (it only has to be parsed once), but this is minor compared to the enormous security benefits. This is probably the single most important step one can take to secure a web application. </p>

<h2>Limit database permissions and segregate users</h2>
<p>In the case at hand, we observed just two interactions that are made not in the context of a logged-in user: &quot;log in&quot; and &quot;send me password&quot;. The web application ought to use a database connection with the most limited rights possible: query-only access to the members table, and no access to any other table.</p>
<p>The effect here is that even a &quot;successful&quot; SQL injection attack is going to have much more limited success. Here, we'd not have been able to do the UPDATE request that ultimately granted us access, so we'd have had to resort to other avenues.</p>
<p>Once the web application determined that a set of valid credentials had been passed via the login form, it would then switch that session to a database connection with more rights.</p>
<p>It should go almost without saying that sa rights should never be used for any web-based application.</p>

<h2>Use stored procedures for database access</h2>
<p>When the database server supports them, use stored procedures for performing access on the application's behalf, which can eliminate SQL entirely (assuming the stored procedures themselves are written properly). </p>
<p>By encapsulating the rules for a certain action - query, update, delete, etc. - into a single procedure, it can be tested and documented on a standalone basis and business rules enforced (for instance, the &quot;add new order&quot; procedure might reject that order if the customer were over his credit limit). </p>
<p>For simple queries this might be only a minor benefit, but as the operations become more complicated (or are used in more than one place), having a single definition for the operation means it's going to be more robust and easier to maintain. </p>
<p><i>Note: </i>it's always possible to write a stored procedure that itself constructs a query dynamically: this provides no protection against SQL Injection - it's only proper binding with prepare/execute or direct SQL statements with bound variables that provide this protection. </p>

<h2>Isolate the webserver</h2>
<p>Even having taken all these mitigation steps, it's nevertheless still possible to miss something and leave the server open to compromise. One ought to design the network infrastructure to assume that the bad guy will have full administrator access to the machine, and then attempt to limit how that can be leveraged to compromise other things. </p>
<p>For instance, putting the machine in a DMZ with extremely limited pinholes &quot;inside&quot; the network means that even getting complete control of the webserver doesn't automatically grant full access to everything else. This won't stop everything, of course, but it makes it a lot harder. </p>

<h2>Configure error reporting</h2>
<p>The default error reporting for some frameworks includes developer debugging information, and this cannot be shown to outside users. Imagine how much easier a time it makes for an attacker if the full query is shown, pointing to the syntax error involved. </p>
<p>This information is useful to developers, but it should be restricted - if possible - to just internal users. </p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input. <br/>Check detailed information for more information about fixing this vulnerability.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php HTTP/1.1
Cookie: login=-1'%20OR%203*2*1=6%20AND%20000480=000480%20--%20
X-Requested-With: XMLHttpRequest
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:57:11 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3976
]]></Response>
        </TechnicalDetails>
        <CWE id="89"><![CDATA[CWE-89]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:P/I:P/A:P]]></Descriptor>
          <Score><![CDATA[6.8]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix SQL Injection Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: SQL Injection tutorial]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-sql-injection-tutorial/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Injection Flaws]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Injection_Flaws]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How to check for SQL injection vulnerabilities]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/sql-injection2/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[SQL Injection Walkthrough]]></Database>
            <URL><![CDATA[http://www.securiteam.com/securityreviews/5DP0N1P76E.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="132" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/search.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /search.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:14 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3864
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="133" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/cart.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /cart.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:15 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4040
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="134" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/index.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /index.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:15 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="135" color="orange">
        <Name><![CDATA[Backup files]]></Name>
        <ModuleName><![CDATA[Scripting (Backup_File.script)]]></ModuleName>
        <Details><![CDATA[This file was found using the pattern <font color="dark"><b>${fileName}.bak</b></font>.<br/>Original filename: <font color="dark"><b>index.php</b></font><br/>Source code pattern found: <code><pre wrap="virtual">&lt;?PHP require_once(&quot;database_connect.php&quot;); ?&gt;
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
&quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;!-- InstanceBegin template=&quot;/Templates/main_dynamic_template.dwt.php&quot; codeOutsideHTMLIsLocked=&quot;false&quot; --&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-2&quot;&gt;

&lt;!-- InstanceBeginEditable name=&quot;document_title_rgn&quot; --&gt;
&lt;title&gt;Home of WASP Art&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot; type=&quot;text/css&quot;&gt;
&lt;!-- InstanceBeginEditable name=&quot;headers_rgn&quot; --&gt;
&lt;!-- here goes headers headers --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;script language=&quot;JavaScript&quot; type=&quot;text/JavaScript&quot;&gt;
&lt;!--
function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName==&quot;Netscape&quot;)&amp;&amp;(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);
//--&gt;
&lt;/script&gt;

&lt;/head&gt;
&lt;body&gt; 
&lt;div id=&quot;mainLayer&quot; style=&quot;position:absolute; width:700px; z-index:1&quot;&gt;
&lt;div id=&quot;masthead&quot;&gt; 
  &lt;h1 id=&quot;siteName&quot;&gt;ACUNETIX ART&lt;/h1&gt;   
  &lt;h6 id=&quot;siteInfo&quot;&gt;TEST and Demonstration site for Acunetix Web Vulnerability Scanner&lt;/h6&gt;
  &lt;div id=&quot;globalNav&quot;&gt; 
    &lt;a href=&quot;index.php&quot;&gt;home&lt;/a&gt; | &lt;a href=&quot;categories.php&quot;&gt;categories&lt;/a&gt; | &lt;a href=&quot;artists.php&quot;&gt;artists
	&lt;/a&gt; | &lt;a href=&quot;disclaimer.php&quot;&gt;disclaimer&lt;/a&gt; | &lt;a href=&quot;cart.php&quot;&gt;your cart&lt;/a&gt; | 
	&lt;a href=&quot;guestbook.php&quot;&gt;guestbook&lt;/a&gt;
  &lt;/div&gt; 
&lt;/div&gt; 
&lt;!-- end masthead --&gt; 

&lt;!-- begin content --&gt;
&lt;!-- InstanceBeginEditable name=&quot;content_rgn&quot; --&gt;
&lt;div id=&quot;content&quot;&gt;
	&lt;h2 id=&quot;pageName&quot;&gt;welcome to our page&lt;/h2&gt;
	  &lt;div class=&quot;story&quot;&gt;
		&lt;h3&gt;Test site for WASP.&lt;/h3&gt;
	  &lt;/div&gt;
&lt;/div&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;!--end content --&gt;

&lt;div id=&quot;navBar&quot;&gt; 
  &lt;div id=&quot;search&quot;&gt; 
    &lt;form action=&quot;search.php&quot; method=&quot;post&quot;&gt; 
      &lt;label&gt;search art&lt;/label&gt; 
      &lt;input name=&quot;searchFor&quot; type=&quot;text&quot; size=&quot;10&quot;&gt; 
      &lt;input name=&quot;goButton&quot; type=&quot;submit&quot; value=&quot;go&quot;&gt; 
    &lt;/form&gt; 
  &lt;/div&gt; 
  &lt;div id=&quot;sectionLinks&quot;&gt; 
    &lt;ul&gt; 
      &lt;li&gt;&lt;a href=&quot;categories.php&quot;&gt;Browse categories&lt;/a&gt;&lt;/li&gt; 
      &lt;li&gt;&lt;a href=&quot;artists.php&quot;&gt;Browse artists&lt;/a&gt;&lt;/li&gt; 
      &lt;li&gt;&lt;a href=&quot;cart.php&quot;&gt;Your cart&lt;/a&gt;&lt;/li&gt; 
      &lt;li&gt;&lt;a href=&quot;login.php&quot;&gt;Signup&lt;/a&gt;&lt;/li&gt;
	  &lt;li&gt;&lt;a href=&quot;userinfo.php&quot;&gt;Your profile&lt;/a&gt;&lt;/li&gt;
	  &lt;li&gt;&lt;a href=&quot;guestbook.php&quot;&gt;Our guestbook&lt;/a&gt;&lt;/li&gt;
	  &lt;?PHP if (isset($_COOKIE[&quot;login&quot;]))echo '&lt;li&gt;&lt;a href=&quot;../logout.php&quot;&gt;Logout&lt;/a&gt;'; ?&gt;&lt;/li&gt; 
    &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;relatedLinks&quot;&gt; 
    &lt;h3&gt;Links&lt;/h3&gt; 
    &lt;ul&gt; 
      &lt;li&gt;&lt;a href=&quot;http://www.acunetix.com&quot;&gt;Security art&lt;/a&gt;&lt;/li&gt; 
	  &lt;li&gt;&lt;a href=&quot;http://www.eclectasy.com/Fractal-Explorer/index.html&quot;&gt;Fractal Explorer&lt;/a&gt;&lt;/li&gt; 
    &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div id=&quot;advert&quot;&gt; 
    &lt;p&gt;&lt;img src=&quot;images/add.jpg&quot; alt=&quot;&quot; width=&quot;107&quot; height=&quot;66&quot;&gt;&lt;/p&gt;
  &lt;/div&gt; 
&lt;/div&gt; 

&lt;!--end navbar --&gt; 
&lt;div id=&quot;siteInfo&quot;&gt;  &lt;a href=&quot;http://www.acunetix.com&quot;&gt;About Us&lt;/a&gt; | &lt;a href=&quot;redir.php?r=index.php&quot;&gt;Site
  Map&lt;/a&gt; | &lt;a href=&quot;privacy.php&quot;&gt;Privacy Policy&lt;/a&gt; | &lt;a href=&quot;mailto:wasp@acunetix.com&quot;&gt;Contact Us&lt;/a&gt; | &amp;copy;2004
  Acunetix Ltd 
&lt;/div&gt; 
&lt;br&gt; 
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</pre></code>]]></Details>
        <Affects><![CDATA[/index.bak]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Backup files can contain script sources, configuration files or other sensitive information that may help an malicious user to prepare more advanced attacks.]]></Impact>
        <Description><![CDATA[A possible backup file was found on your web-server. These files are usually created by developers to backup their work.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the file(s) if they are not required on your website. As an additional step, it is recommended to implement a security policy within your organization to disallow creation of backup files in directories accessible from the web.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /index.bak HTTP/1.1
Range: bytes=0-99999
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 206 Partial Content
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:07:00 GMT
Content-Type: text/plain
Content-Length: 3265
Last-Modified: Wed, 11 May 2011 10:27:48 GMT
Connection: keep-alive
ETag: &quot;4dca64a4-cc1&quot;
Content-Range: bytes 0-3264/3265
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Testing for Old, Backup and Unreferenced Files (OWASP-CM-006)]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Testing_for_Old,_Backup_and_Unreferenced_Files_(OWASP-CM-006)]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Security Tips for Server Configuration]]></Database>
            <URL><![CDATA[http://httpd.apache.org/docs/1.3/misc/security_tips.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Protecting Confidential Documents at Your Site]]></Database>
            <URL><![CDATA[http://www.w3.org/Security/Faq/wwwsf5.html]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="136" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/login.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /login.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:15 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4671
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="137" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/artists.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /artists.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:16 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4461
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="138" color="orange">
        <Name><![CDATA[Backup files]]></Name>
        <ModuleName><![CDATA[Scripting (Backup_File.script)]]></ModuleName>
        <Details><![CDATA[This file was found using the pattern <font color="dark"><b>${fileName}.zip</b></font>.<br/>Original filename: <font color="dark"><b>index.php</b></font><br/>Source code pattern found: <code><pre wrap="virtual">&lt;?PHP require_once(&quot;database_connect.php&quot;); ?&gt;
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
&quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;!-- InstanceBegin template=&quot;/Templates/main_dynamic_template.dwt.php&quot; codeOutsideHTMLIsLocked=&quot;false&quot; --&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-2&quot;&gt;

&lt;!-- InstanceBeginEditable name=&quot;document_title_rgn&quot; --&gt;
&lt;title&gt;Home of WASP Art&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot; type=&quot;text/css&quot;&gt;
&lt;!-- InstanceBeginEditable name=&quot;headers_rgn&quot; --&gt;
&lt;!-- here goes headers headers --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;script language=&quot;JavaScript&quot; type=&quot;text/JavaScript&quot;&gt;
&lt;!--
function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName==&quot;Netscape&quot;)&amp;&amp;(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);
//--&gt;
&lt;/script&gt;

&lt;/head&gt;
&lt;body&gt; 
&lt;div id=&quot;mainLayer&quot; style=&quot;position:absolute; width:700px; z-index:1&quot;&gt;
&lt;div id=&quot;masthead&quot;&gt; 
  &lt;h1 id=&quot;siteName&quot;&gt;ACUNETIX ART&lt;/h1&gt;   
  &lt;h6 id=&quot;siteInfo&quot;&gt;TEST and Demonstration site for Acunetix Web Vulnerability Scanner&lt;/h6&gt;
  &lt;div id=&quot;globalNav&quot;&gt; 
    &lt;a href=&quot;index.php&quot;&gt;home&lt;/a&gt; | &lt;a href=&quot;categories.php&quot;&gt;categories&lt;/a&gt; | &lt;a href=&quot;artists.php&quot;&gt;artists
	&lt;/a&gt; | &lt;a href=&quot;disclaimer.php&quot;&gt;disclaimer&lt;/a&gt; | &lt;a href=&quot;cart.php&quot;&gt;your cart&lt;/a&gt; | 
	&lt;a href=&quot;guestbook.php&quot;&gt;guestbook&lt;/a&gt;
  &lt;/div&gt; 
&lt;/div&gt; 
&lt;!-- end masthead --&gt; 

&lt;!-- begin content --&gt;
&lt;!-- InstanceBeginEditable name=&quot;content_rgn&quot; --&gt;
&lt;div id=&quot;content&quot;&gt;
	&lt;h2 id=&quot;pageName&quot;&gt;welcome to our page&lt;/h2&gt;
	  &lt;div class=&quot;story&quot;&gt;
		&lt;h3&gt;Test site for WASP.&lt;/h3&gt;
	  &lt;/div&gt;
&lt;/div&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;!--end content --&gt;

&lt;div id=&quot;navBar&quot;&gt; 
  &lt;div id=&quot;search&quot;&gt; 
    &lt;form action=&quot;search.php&quot; method=&quot;post&quot;&gt; 
      &lt;label&gt;search art&lt;/label&gt; 
      &lt;input name=&quot;searchFor&quot; type=&quot;text&quot; size=&quot;10&quot;&gt; 
      &lt;input name=&quot;goButton&quot; type=&quot;submit&quot; value=&quot;go&quot;&gt; 
    &lt;/form&gt; 
  &lt;/div&gt; 
  &lt;div id=&quot;sectionLinks&quot;&gt; 
    &lt;ul&gt; 
      &lt;li&gt;&lt;a href=&quot;categories.php&quot;&gt;Browse categories&lt;/a&gt;&lt;/li&gt; 
      &lt;li&gt;&lt;a href=&quot;artists.php&quot;&gt;Browse artists&lt;/a&gt;&lt;/li&gt; 
      &lt;li&gt;&lt;a href=&quot;cart.php&quot;&gt;Your cart&lt;/a&gt;&lt;/li&gt; 
      &lt;li&gt;&lt;a href=&quot;login.php&quot;&gt;Signup&lt;/a&gt;&lt;/li&gt;
	  &lt;li&gt;&lt;a href=&quot;userinfo.php&quot;&gt;Your profile&lt;/a&gt;&lt;/li&gt;
	  &lt;li&gt;&lt;a href=&quot;guestbook.php&quot;&gt;Our guestbook&lt;/a&gt;&lt;/li&gt;
	  &lt;?PHP if (isset($_COOKIE[&quot;login&quot;]))echo '&lt;li&gt;&lt;a href=&quot;../logout.php&quot;&gt;Logout&lt;/a&gt;'; ?&gt;&lt;/li&gt; 
    &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;relatedLinks&quot;&gt; 
    &lt;h3&gt;Links&lt;/h3&gt; 
    &lt;ul&gt; 
      &lt;li&gt;&lt;a href=&quot;http://www.acunetix.com&quot;&gt;Security art&lt;/a&gt;&lt;/li&gt; 
	  &lt;li&gt;&lt;a href=&quot;http://www.eclectasy.com/Fractal-Explorer/index.html&quot;&gt;Fractal Explorer&lt;/a&gt;&lt;/li&gt; 
    &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div id=&quot;advert&quot;&gt; 
    &lt;p&gt;&lt;img src=&quot;images/add.jpg&quot; alt=&quot;&quot; width=&quot;107&quot; height=&quot;66&quot;&gt;&lt;/p&gt;
  &lt;/div&gt; 
&lt;/div&gt; 

&lt;!--end navbar --&gt; 
&lt;div id=&quot;siteInfo&quot;&gt;  &lt;a href=&quot;http://www.acunetix.com&quot;&gt;About Us&lt;/a&gt; | &lt;a href=&quot;redir.php?r=index.php&quot;&gt;Site
  Map&lt;/a&gt; | &lt;a href=&quot;privacy.php&quot;&gt;Privacy Policy&lt;/a&gt; | &lt;a href=&quot;mailto:wasp@acunetix.com&quot;&gt;Contact Us&lt;/a&gt; | &amp;copy;2004
  Acunetix Ltd 
&lt;/div&gt; 
&lt;br&gt; 
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</pre></code>]]></Details>
        <Affects><![CDATA[/index.zip]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Backup files can contain script sources, configuration files or other sensitive information that may help an malicious user to prepare more advanced attacks.]]></Impact>
        <Description><![CDATA[A possible backup file was found on your web-server. These files are usually created by developers to backup their work.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the file(s) if they are not required on your website. As an additional step, it is recommended to implement a security policy within your organization to disallow creation of backup files in directories accessible from the web.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /index.zip HTTP/1.1
Range: bytes=0-99999
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 206 Partial Content
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:07:21 GMT
Content-Type: application/zip
Content-Length: 3265
Last-Modified: Mon, 09 Jul 2007 10:42:54 GMT
Connection: keep-alive
ETag: &quot;4692112e-cc1&quot;
Content-Range: bytes 0-3264/3265
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Testing for Old, Backup and Unreferenced Files (OWASP-CM-006)]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Testing_for_Old,_Backup_and_Unreferenced_Files_(OWASP-CM-006)]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Security Tips for Server Configuration]]></Database>
            <URL><![CDATA[http://httpd.apache.org/docs/1.3/misc/security_tips.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Protecting Confidential Documents at Your Site]]></Database>
            <URL><![CDATA[http://www.w3.org/Security/Faq/wwwsf5.html]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="139" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/guestbook.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /guestbook.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:17 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4531
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="140" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/categories.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /categories.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:17 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5248
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="141" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/disclaimer.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /disclaimer.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:18 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4667
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="142" color="green">
        <Name><![CDATA[Microsoft Office possible sensitive information]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;o:DocumentProperties&gt;
  &lt;o:Author&gt;Acunetix&lt;/o:Author&gt;
  &lt;o:LastAuthor&gt;Acunetix&lt;/o:LastAuthor&gt;
  &lt;o:Revision&gt;1&lt;/o:Revision&gt;
  &lt;o:TotalTime&gt;0&lt;/o:TotalTime&gt;
  &lt;o:Created&gt;2005-04-05T11:44:00Z&lt;/o:Created&gt;
  &lt;o:LastSaved&gt;2005-04-05T11:44:00Z&lt;/o:LastSaved&gt;
  &lt;o:Pages&gt;1&lt;/o:Pages&gt;
  &lt;o:Words&gt;5&lt;/o:Words&gt;
  &lt;o:Characters&gt;30&lt;/o:Characters&gt;
  &lt;o:Company&gt;Acunetix&lt;/o:Company&gt;
  &lt;o:Lines&gt;1&lt;/o:Lines&gt;
  &lt;o:Paragraphs&gt;1&lt;/o:Paragraphs&gt;
  &lt;o:CharactersWithSpaces&gt;34&lt;/o:CharactersWithSpaces&gt;
  &lt;o:Version&gt;11.6360&lt;/o:Version&gt;
 &lt;/o:DocumentProperties&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/secured/office.htm]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure that may help an attacker to conduct social engineering attacks.]]></Impact>
        <Description><![CDATA[This document has been converted to HTML using Microsoft Office. It seems that Office has included sensitive information during the conversion.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Inspect the source code of this document and remove the sensitive information.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/office.htm HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Last-Modified: Wed, 11 May 2011 10:27:44 GMT
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 3728
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[iMPERVA Source Code Disclosure]]></Database>
            <URL><![CDATA[http://www.imperva.com/application_defense_center/glossary/source_code_disclosure.html]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="143" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">root@dessler.cse.buffalo.edu
root@localhost.localdomain
license@php.net
</font></pre>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="144" color="green">
        <Name><![CDATA[Possible internal IP address disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">192.168.0.5</font></pre>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[A string matching an internal IPv4 address was found on this page. This may disclose information about the IP addressing scheme of the internal network. This information can be used to conduct further attacks.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Prevent this information from being displayed to the user.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="145" color="orange">
        <Name><![CDATA[PHPinfo page found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;phpinfo()&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[This file may expose sensitive information that may help an malicious user to prepare more advanced attacks.]]></Impact>
        <Description><![CDATA[This script is using phpinfo() function. This function outputs a large amount of information about the current state of PHP. This includes information about PHP compilation options and extensions, the PHP version, server information and environment (if compiled as a module), the PHP environment, OS version information, paths, master and local values of configuration options, HTTP headers, and the PHP License.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the file from production systems.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP phpinfo]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/function.phpinfo.php]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="146" color="green">
        <Name><![CDATA[Possible server path disclosure (Unix)]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">/usr/obj/usr/src/sys/GENERIC</font></pre>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[One or more fully qualified path names were found on this page. From this information the attacker may learn the file system structure from the web server. This information can be used to conduct further attacks.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Prevent this information from being displayed to the user.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="147" color="orange">
        <Name><![CDATA[Error message on page]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;b&gt;Warning&lt;/b&gt;: mysql_connect(): Access denied for user 'wauser'@'localhost' (using password: NO) in &lt;b&gt;/hj/var/www//secured/database_connect.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/secured/database_connect.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/database_connect.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 251
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="148" color="green">
        <Name><![CDATA[Possible username or password disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">password: NO</font></pre>]]></Details>
        <Affects><![CDATA[/secured/database_connect.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[A username and/or password was found in this file. This information could be sensitive.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove this file from your website or change its permissions to remove access.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/database_connect.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 251
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="149" color="blue">
        <Name><![CDATA[MySQL username disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">Access denied for user 'wauser'@'localhost' (using password: NO)</font></pre>]]></Details>
        <Affects><![CDATA[/secured/database_connect.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[This file may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[For a client program to be able to connect to the MySQL server, it must use the proper connection parameters, such as the name of the host where the server is running and the user name and password of your MySQL account. <br/><br/>When the connection to the database cannot be established, the server returns an error message including the MySQL username and host that were used. This information should not be present on a production system.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Make sure the MySQL connection can be established and configure PHP not to display error messages.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/database_connect.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:23 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 251
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="150" color="orange">
        <Name><![CDATA[Error message on page]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;b&gt;Warning&lt;/b&gt;: mysql_fetch_array() expects parameter 1 to be resource, boolean given in &lt;b&gt;/hj/var/www//AJAX/infotitle.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/AJAX/infotitle.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/infotitle.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:31 GMT
Content-Type: text/xml
Content-Length: 172
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="151" color="orange">
        <Name><![CDATA[Error message on page]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;b&gt;Warning&lt;/b&gt;: mysql_fetch_array() expects parameter 1 to be resource, boolean given in &lt;b&gt;/hj/var/www//AJAX/infoartist.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/AJAX/infoartist.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/infoartist.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:32 GMT
Content-Type: text/xml
Content-Length: 175
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="152" color="orange">
        <Name><![CDATA[Error message on page]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;b&gt;Warning&lt;/b&gt;: mysql_fetch_array() expects parameter 1 to be resource, boolean given in &lt;b&gt;/hj/var/www//AJAX/infocateg.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/AJAX/infocateg.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /AJAX/infocateg.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:33 GMT
Content-Type: text/xml
Content-Length: 172
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="153" color="orange">
        <Name><![CDATA[Source code disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;?php
// ** MySQL settings ** //
define('DB_NAME', 'wp265as');    // The name of the database
define('DB_USER', 'root');     // Your MySQL username
define('DB_PASSWORD', ''); // ...and password
define('DB_HOST', 'localhost');    // 99% chance you won't need to change this value
define('DB_CHARSET', 'utf8');
define('DB_COLLATE', '');

// Change each KEY to a different unique phrase.  You won't have to remember the phrases later,
// so make them long and complicated.  You can visit http://api.wordpress.org/secret-key/1.1/
// to get keys generated for you, or just make something up.  Each key should have a different phrase.
define('AUTH_KEY', 'put your unique phrase here'); // Change this to a unique phrase.
define('SECURE_AUTH_KEY', 'put your unique phrase here'); // Change this to a unique phrase.
define('LOGGED_IN_KEY', 'put your unique phrase here'); // Change this to a unique phrase.

// You can have multiple installations in one database if you give each a unique prefix
$table_prefix  = 'w ...</font></pre>]]></Details>
        <Affects><![CDATA[/pictures/wp-config.bak]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker can gather sensitive information (database connection strings, application logic) by analyzing the source code. This information can be used to conduct further attacks.]]></Impact>
        <Description><![CDATA[Looks like the source code for this script is available. This check is using pattern matching to determine if server side tags are found in the file. In some cases this alert may generate false positives. ]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove this file from your website or change its permissions to remove access.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures/wp-config.bak HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:34 GMT
Content-Type: text/plain
Content-Length: 1535
Last-Modified: Wed, 03 Dec 2008 14:37:43 GMT
Connection: keep-alive
ETag: &quot;493699b7-5ff&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Source Code Disclosure Can Be Exploited On Your Website]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/website-source-code-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="154" color="green">
        <Name><![CDATA[Possible internal IP address disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">192.168.0.26</font></pre>]]></Details>
        <Affects><![CDATA[/pictures/ipaddresses.txt]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[A string matching an internal IPv4 address was found on this page. This may disclose information about the IP addressing scheme of the internal network. This information can be used to conduct further attacks.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Prevent this information from being displayed to the user.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures/ipaddresses.txt HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:34 GMT
Content-Type: text/plain
Content-Length: 52
Last-Modified: Fri, 23 Jan 2009 12:59:43 GMT
Connection: keep-alive
ETag: &quot;4979bf3f-34&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="155" color="green">
        <Name><![CDATA[Possible username or password disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">password=something</font></pre>]]></Details>
        <Affects><![CDATA[/pictures/credentials.txt]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[A username and/or password was found in this file. This information could be sensitive.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove this file from your website or change its permissions to remove access.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures/credentials.txt HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:35 GMT
Content-Type: text/plain
Content-Length: 33
Last-Modified: Fri, 23 Jan 2009 10:47:58 GMT
Connection: keep-alive
ETag: &quot;4979a05e-21&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="156" color="orange">
        <Name><![CDATA[Error message on page]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;b&gt;Warning&lt;/b&gt;:  Sablotron error on line 1: XML parser error 3: no element found in &lt;b&gt;/usr/local/etc/httpd/htdocs2/destination-ce/destinationce/system/class/xsltTransform.class.php&lt;/b&gt; on line &lt;b&gt;70&lt;/b&gt;&lt;br /&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/pictures/path-disclosure-unix.html]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures/path-disclosure-unix.html HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:35 GMT
Content-Type: text/html
Last-Modified: Mon, 08 Apr 2013 08:42:10 GMT
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 3936
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="157" color="green">
        <Name><![CDATA[Possible server path disclosure (Unix)]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">/usr/local/etc/httpd/htdocs2/destination</font></pre>]]></Details>
        <Affects><![CDATA[/pictures/path-disclosure-unix.html]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[One or more fully qualified path names were found on this page. From this information the attacker may learn the file system structure from the web server. This information can be used to conduct further attacks.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Prevent this information from being displayed to the user.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures/path-disclosure-unix.html HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:35 GMT
Content-Type: text/html
Last-Modified: Mon, 08 Apr 2013 08:42:10 GMT
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 3936
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="158" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/logout.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /logout.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:35 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Set-Cookie: login=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT
Original-Content-Encoding: gzip
Content-Length: 3965
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="159" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/404.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /404.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4406
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="160" color="green">
        <Name><![CDATA[Possible internal IP address disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">192.168.0.28</font></pre>]]></Details>
        <Affects><![CDATA[/404.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[A string matching an internal IPv4 address was found on this page. This may disclose information about the IP addressing scheme of the internal network. This information can be used to conduct further attacks.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Prevent this information from being displayed to the user.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /404.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4406
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="161" color="red">
        <Name><![CDATA[Cross site scripting (verified)]]></Name>
        <ModuleName><![CDATA[Scripting (XSS_in_URI.script)]]></ModuleName>
        <Details><![CDATA[URI was set to <b><font color="dark">1&lt;ScRiPt&gt;prompt(943418)&lt;/ScRiPt&gt;</font></b><br/>The input is reflected inside a text element.<br/>]]></Details>
        <Affects><![CDATA[/404.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[high]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.
]]></Impact>
        <Description><![CDATA[This script is possibly vulnerable to Cross Site Scripting (XSS) attacks.<br/><br/>
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser. ]]></Description>
        <DetailedInformation><![CDATA[<i>Quote from The Cross Site Scripting FAQ - http://www.cgisecurity.com/articles/xss-faq.shtml </i> 

<h2>Introduction</h2>

<p>Websites today are more complex than ever, containing a lot of dynamic content making the experience for the user more enjoyable. Dynamic content is achieved through the use of web applications which can deliver different output to a user depending on their settings and needs. Dynamic websites suffer from a threat that static websites don't, called &quot;Cross Site Scripting&quot; (or XSS dubbed by other security professionals). Currently small informational tidbits about Cross Site Scripting holes exist but none really explain them to an average person or administrator. This FAQ was written to provide a better understanding of this emerging threat, and to give guidance on detection and prevention.</p>

<h2>&quot;What is Cross Site Scripting?&quot;</h2>

<p>Cross site scripting (also known as XSS) occurs when a web application gathers malicious data from a user. The data is usually gathered in the form of a hyperlink which contains malicious content within it. The user will most likely click on this link from another website, instant message, or simply just reading a web board or email message. Usually the attacker will encode the malicious portion of the link to the site in HEX (or other encoding methods) so the request is less suspicious looking to the user when clicked on. After the data is collected by the web application, it creates an output page for the user containing the malicious data that was originally sent to it, but in a manner to make it appear as valid content from the website. Many popular guestbook and forum programs allow users to submit posts with html and javascript embedded in them. If for example I was logged in as &quot;john&quot; and read a message by &quot;joe&quot; that contained malicious javascript in it, then it may be possible for &quot;joe&quot; to hijack my session just by reading his bulletin board post. Further details on how attacks like this are accomplished via &quot;cookie theft&quot; are explained in detail below.</p>

<h2>&quot;What does XSS and CSS mean?&quot;</h2>

<p>Often people refer to Cross Site Scripting as CSS. There has been a lot of confusion with Cascading Style Sheets (CSS) and cross site scripting. Some security people refer to Cross Site Scripting as XSS. If you hear someone say &quot;I found a XSS hole&quot;, they are talking about Cross Site Scripting for certain.</p>


<h2>&quot;What are the threats of Cross Site Scripting?&quot;</h2>

<p>Often attackers will inject JavaScript, VBScript, ActiveX, HTML, or Flash into a vulnerable application to fool a user (Read below for further details) in order to gather data from them. Everything from account hijacking, changing of user settings, cookie theft/poisoning, or false advertising is possible. New malicious uses are being found every day for XSS attacks. The post below by Brett Moore brings up a good point with regard to &quot;Denial Of Service&quot;, and potential &quot;auto-attacking&quot; of hosts if a user simply reads a post on a message board.</p>

<h2>&quot;What can I do to protect myself as a vendor?&quot;</h2>

<p>This is a simple answer. Never trust user input and always filter metacharacters. This will eliminate the majority of XSS attacks. Converting &lt; and &gt; to &amp;lt; and &amp;gt; is also suggested when it comes to script output. Remember XSS holes can be damaging and costly to your business if abused. Often attackers will disclose these holes to the public, which can erode customer and public confidence in the security and privacy of your organization's site. Filtering &lt; and &gt; alone will not solve all cross site scripting attacks and it is suggested you also attempt to filter out ( and ) by translating them to &amp;#40; and &amp;#41;, and also # and &amp; by translating them to &amp;#35 (#) and &amp;#38 (&amp;).</p>

<h2>&quot;What can I do to protect myself as a user?&quot;</h2>

<p>The easiest way to protect yourself as a user is to only follow links from the main website you wish to view. If you visit one website and it links to CNN for example, instead of clicking on it visit CNN's main site and use its search engine to find the content. This will probably eliminate ninety percent of the problem. Sometimes XSS can be executed automatically when you open an email, email attachment, read a guestbook, or bulletin board post. If you plan on opening an email, or reading a post on a public board from a person you don't know BE CAREFUL. One of the best ways to protect yourself is to turn off Javascript in your browser settings. In IE turn your security settings to high. This can prevent cookie theft, and in general is a safer thing to do.</p>

<h2>&quot;How common are XSS holes?&quot;</h2>

<p>Cross site scripting holes are gaining popularity among hackers as easy holes to find in large websites. Websites from FBI.gov, CNN.com, Time.com, Ebay, Yahoo, Apple computer, Microsoft, Zdnet, Wired, and Newsbytes have all had one form or another of XSS bugs.</p>

<p>Every month roughly 10-25 XSS holes are found in commercial products and advisories are published explaining the threat.</p>


<h2>&quot;Does encryption protect me?&quot;</h2>

<p>Websites that use SSL (https) are in no way more protected than websites that are not encrypted. The web applications work the same way as before, except the attack is taking place in an encrypted connection. People often think that because they see the lock on their browser it means everything is secure. This just isn't the case.</p>


<h2>&quot;Can XSS holes allow command execution?&quot;</h2>

<p>XSS holes can allow Javascript insertion, which may allow for limited execution. If an attacker were to exploit a browser flaw (browser hole) it could then be possible to execute commands on the client's side. If command execution were possible it would only be possible on the client side. In simple terms XSS holes can be used to help exploit other holes that may exist in your browser.</p>


<h2>&quot;What if I don't feel like fixing a CSS/XSS Hole?&quot;</h2>

<p>By not fixing an XSS hole this could allow possible user account compromise in portions of your site as they get added or updated. Cross Site Scripting has been found in various large sites recently and have been widely publicized. Left unrepaired, someone may discover it and publish a warning about your company. This may damage your company's reputation, depicting it as being lax on security matters. This of course also sends the message to your clients that you aren't dealing with every problem that arises, which turns into a trust issue. If your client doesn't trust you why would they wish to do business with you?</p>]]></DetailedInformation>
        <Recommendation><![CDATA[Your script should filter metacharacters from user input.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /404.php?1&lt;ScRiPt&gt;prompt(943418)&lt;/ScRiPt&gt; HTTP/1.1
Referer: http://testphp.vulnweb.com:80/
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:09:34 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4439
]]></Response>
        </TechnicalDetails>
        <CWE id="79"><![CDATA[CWE-79]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:M/Au:N/C:N/I:P/A:N]]></Descriptor>
          <Score><![CDATA[4.4]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Medium]]></AC>
          <ACdesc><![CDATA[The access conditions are somewhat specialized.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[Partial]]></I>
          <Idesc><![CDATA[Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Acunetix Cross Site Scripting Attack]]></Database>
            <URL><![CDATA[http://www.acunetix.com/websitesecurity/cross-site-scripting.htm]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[VIDEO: How Cross-Site Scripting (XSS) Works]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/video-how-cross-site-scripting-xss-works/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[The Cross Site Scripting Faq]]></Database>
            <URL><![CDATA[http://www.cgisecurity.com/xss-faq.html]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP Cross Site Scripting]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/Cross_Site_Scripting]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Annihilation]]></Database>
            <URL><![CDATA[http://ha.ckers.org/blog/20060602/xss-annihilation/]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[XSS Filter Evasion Cheat Sheet]]></Database>
            <URL><![CDATA[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[Cross site scripting]]></Database>
            <URL><![CDATA[http://en.wikipedia.org/wiki/Cross-site_scripting ]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[OWASP PHP Top 5]]></Database>
            <URL><![CDATA[http://www.owasp.org/index.php/PHP_Top_5]]></URL>
          </Reference>
          <Reference>
            <Database><![CDATA[How To: Prevent Cross-Site Scripting in ASP.NET]]></Database>
            <URL><![CDATA[http://msdn.microsoft.com/en-us/library/ms998274.aspx]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="162" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/Templates/main_dynamic_template.dwt.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Templates/main_dynamic_template.dwt.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3830
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="163" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wasp@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/index.bak]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /index.bak HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/plain
Content-Length: 3265
Last-Modified: Wed, 11 May 2011 10:27:48 GMT
Connection: keep-alive
ETag: &quot;4dca64a4-cc1&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="164" color="orange">
        <Name><![CDATA[Source code disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;?PHP require_once(&quot;database_connect.php&quot;); ?&gt;
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
&quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;!-- InstanceBegin template=&quot;/Templates/main_dynamic_template.dwt.php&quot; codeOutsideHTMLIsLocked=&quot;false&quot; --&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-2&quot;&gt;

&lt;!-- InstanceBeginEditable name=&quot;document_title_rgn&quot; --&gt;
&lt;title&gt;Home of WASP Art&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot; type=&quot;text/css&quot;&gt;
&lt;!-- InstanceBeginEditable name=&quot;headers_rgn&quot; --&gt;
&lt;!-- here goes headers headers --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;script language=&quot;JavaScript&quot; type=&quot;text/JavaScript&quot;&gt;
&lt;!--
function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName==&quot;Netscape&quot;)&amp;&amp;(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.re ...</font></pre>]]></Details>
        <Affects><![CDATA[/index.bak]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[An attacker can gather sensitive information (database connection strings, application logic) by analyzing the source code. This information can be used to conduct further attacks.]]></Impact>
        <Description><![CDATA[Looks like the source code for this script is available. This check is using pattern matching to determine if server side tags are found in the file. In some cases this alert may generate false positives. ]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove this file from your website or change its permissions to remove access.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /index.bak HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/plain
Content-Length: 3265
Last-Modified: Wed, 11 May 2011 10:27:48 GMT
Connection: keep-alive
ETag: &quot;4dca64a4-cc1&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Source Code Disclosure Can Be Exploited On Your Website]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/website-source-code-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="165" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/product.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /product.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4195
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="166" color="orange">
        <Name><![CDATA[Error message on page]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;b&gt;Warning&lt;/b&gt;: mysql_fetch_array() expects parameter 1 to be resource, null given in &lt;b&gt;/hj/var/www//listproducts.php&lt;/b&gt; on line &lt;b&gt;55&lt;/b&gt;&lt;br /&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3977
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="167" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/listproducts.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /listproducts.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 3977
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="168" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/signup.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /signup.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:37 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 5183
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="169" color="orange">
        <Name><![CDATA[Error message on page]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">Fatal error</font></pre>]]></Details>
        <Affects><![CDATA[/Connections/DB_Connection.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[The error messages may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[This page contains an error/warning message that may disclose sensitive information. The message can also contain the location of the file that produced the unhandled exception.<br/><br/>
This may be a false positive if the error message is found in documentation pages.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Review the source code for this script. ]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Connections/DB_Connection.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:38 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 332
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="170" color="green">
        <Name><![CDATA[Possible username or password disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">password: NO</font></pre>]]></Details>
        <Affects><![CDATA[/Connections/DB_Connection.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[A username and/or password was found in this file. This information could be sensitive.<br/><br/> <div class="coolbox"><font color="dark">This alert may be a false positive, manual confirmation is required.</font></div>]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove this file from your website or change its permissions to remove access.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Connections/DB_Connection.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:38 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 332
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="171" color="blue">
        <Name><![CDATA[MySQL username disclosure]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_File.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">Access denied for user 'root'@'localhost' (using password: NO)</font></pre>]]></Details>
        <Affects><![CDATA[/Connections/DB_Connection.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[This file may disclose sensitive information. This information can be used to launch further attacks.]]></Impact>
        <Description><![CDATA[For a client program to be able to connect to the MySQL server, it must use the proper connection parameters, such as the name of the host where the server is running and the user name and password of your MySQL account. <br/><br/>When the connection to the database cannot be established, the server returns an error message including the MySQL username and host that were used. This information should not be present on a production system.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Make sure the MySQL connection can be established and configure PHP not to display error messages.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Connections/DB_Connection.php HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:38 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 332
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="172" color="green">
        <Name><![CDATA[Email address found]]></Name>
        <ModuleName><![CDATA[Scripting (Text_Search_Dir.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">wvs@acunetix.com
</font></pre>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[info]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Email addresses posted on Web sites may attract spam.]]></Impact>
        <Description><![CDATA[One or more email addresses have been found on this page. The majority of spam comes from email addresses harvested off the internet. The spam-bots (also known as email harvesters and email extractors) are programs that scour the internet looking for email addresses on any website they come across.  Spambot programs look for strings like myname@mydomain.com and then record any addresses found.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Check references for details on how to solve this problem.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET / HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: filelist;aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:13 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 4096
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Email Address Disclosed on Website Can be Used for Spam]]></Database>
            <URL><![CDATA[http://www.websitedefender.com/web-security/email-address-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="173" color="orange">
        <Name><![CDATA[JetBrains .idea project directory]]></Name>
        <ModuleName><![CDATA[Scripting (JetBrains_Idea_Project_Directory.script)]]></ModuleName>
        <Details><![CDATA[workspace.xml project file found at : <font color="dark">/.idea/workspace.xml</font><br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;project version=&quot;4&quot;&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[These files may expose sensitive information that may help an malicious user to prepare more advanced attacks.]]></Impact>
        <Description><![CDATA[The .idea directory contains a set of configuration files (.xml) for your project. These configuration files  contain information core to the project itself, such as names and locations of its component modules, compiler settings, etc. If you've defined a data source the file dataSources.ids contains information for connecting to the database and credentials. The workspace.xml file stores personal settings such as placement and positions of your windows, your VCS and History settings, and other data pertaining to the development environment. It also contains a list of changed files and other sensitive information. These files should not be present on a production system.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove these files from production systems or restrict access to the .idea directory. To deny access to all the .idea folders you need to add the following lines in the appropriate context (either global config, or vhost/directory, or from .htaccess):
<code><pre wrap="virtual">
&lt;Directory ~ &quot;\.idea&quot;&gt;
Order allow,deny
Deny from all
&lt;/Directory&gt;
</pre></code>]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /.idea/workspace.xml HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:11:03 GMT
Content-Type: text/xml
Content-Length: 12473
Last-Modified: Fri, 20 Apr 2012 08:23:07 GMT
Connection: keep-alive
ETag: &quot;4f911ceb-30b9&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Apache Tips & Tricks: Deny access to some folders]]></Database>
            <URL><![CDATA[http://www.ducea.com/2006/08/11/apache-tips-tricks-deny-access-to-some-folders/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="174" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /Flash/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/Flash]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Flash/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/Flash/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:50 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 387
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="175" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /images/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/images]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /images/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/images/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:50 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 393
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="176" color="orange">
        <Name><![CDATA[.htaccess file readable]]></Name>
        <ModuleName><![CDATA[Scripting (htaccess_File_Readable.script)]]></ModuleName>
        <Details><![CDATA[No details are available.]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[Possible sensitive information disclosure.]]></Impact>
        <Description><![CDATA[This directory contains an <b>.htaccess</b> file that is readable. This may indicate a server misconfiguration. htaccess files are designed to be parsed by web server and should not be directly accessible. These files could contain sensitive information that could help an attacker to conduct further attacks. It's recommended to restrict access to this file.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Restrict access to the .htaccess file by adjusting the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/.htaccess HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:11:26 GMT
Content-Type: text/plain
Content-Length: 176
Last-Modified: Wed, 15 Feb 2012 10:32:40 GMT
Connection: keep-alive
ETag: &quot;4f3b89c8-b0&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
      <ReportItem id="177" color="orange">
        <Name><![CDATA[PHPinfo page found]]></Name>
        <ModuleName><![CDATA[Scripting (PHPInfo.script)]]></ModuleName>
        <Details><![CDATA[phpinfo() page found at : <font color="dark">/secured/phpinfo.php</font>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[This file may expose sensitive information that may help an malicious user to prepare more advanced attacks.]]></Impact>
        <Description><![CDATA[PHPinfo page has been found in this directory. The PHPinfo page outputs a large amount of information about the current state of PHP. This includes information about PHP compilation options and extensions, the PHP version, server information and environment (if compiled as a module), the PHP environment, OS version information, paths, master and local values of configuration options, HTTP headers, and the PHP License.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove the file from production systems.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:11:35 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="200"><![CDATA[CWE-200]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[PHP phpinfo]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/function.phpinfo.php]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="178" color="orange">
        <Name><![CDATA[PHP allow_url_fopen enabled]]></Name>
        <ModuleName><![CDATA[Scripting (PHPInfo.script)]]></ModuleName>
        <Details><![CDATA[This vulnerability was detected using the information from phpinfo() page <font color="dark">/secured/phpinfo.php</font><br/>allow_url_fopen: <font color="dark"><b>On</b></font>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[Application dependant - possible remote file inclusion.]]></Impact>
        <Description><![CDATA[The PHP configuration directive allow_url_fopen is enabled. When enabled, this directive allows data retrieval from remote locations (web site or FTP server). A large number of code injection vulnerabilities reported in PHP-based web applications are caused by the combination of enabling allow_url_fopen and bad input filtering. <br/><br/>allow_url_fopen is enabled by default.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[You can disable allow_url_fopen from php.ini or .htaccess.<br/><br/><b>php.ini</b><br/>allow_url_fopen = 'off'<br/><br/><b>.htaccess</b><br/>php_flag  allow_url_fopen off<br/>]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:11:35 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/filesystem.configuration.php]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="179" color="orange">
        <Name><![CDATA[PHP open_basedir is not set]]></Name>
        <ModuleName><![CDATA[Scripting (PHPInfo.script)]]></ModuleName>
        <Details><![CDATA[This vulnerability was detected using the information from phpinfo() page <font color="dark">/secured/phpinfo.php</font><br/>open_basedir: <font color="dark"><b>no value</b></font>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[Application dependant - possible remote code inclusion.]]></Impact>
        <Description><![CDATA[The open_basedir configuration directive will limit the files that can be opened by PHP to the specified directory-tree. When a script tries to open a file with, for example, fopen() or gzopen(), the location of the file is checked. When the file is outside the specified directory-tree, PHP will refuse to open it. open_basedir is a good protection against remote file inclusion vulnerabilities. For a remote attacker it is not possible to break out of the open_basedir restrictions if he is only able to inject the name of a file to be included. Therefore the number of files he will be able to include with such a local file include vulnerability is limited.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[You can set open_basedir from php.ini <br/><br/><b>php.ini</b><br/>open_basedir = your_application_directory<br/>]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:11:35 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:N]]></Descriptor>
          <Score><![CDATA[0.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Description of core php.ini directives]]></Database>
            <URL><![CDATA[http://php.net/ini.core]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="180" color="orange">
        <Name><![CDATA[PHP errors enabled]]></Name>
        <ModuleName><![CDATA[Scripting (PHPInfo.script)]]></ModuleName>
        <Details><![CDATA[This vulnerability was detected using the information from phpinfo() page <font color="dark">/secured/phpinfo.php</font><br/>display_errors: <font color="dark"><b>On</b></font>]]></Details>
        <Affects><![CDATA[/secured/phpinfo.php]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Configuration]]></Type>
        <Impact><![CDATA[Possible information disclosure.]]></Impact>
        <Description><![CDATA[The display_errors directive determines whether error messages should be sent to the browser. These messages frequently contain sensitive information about your web application environment, and should never be presented to untrusted sources. <br/><br/>display_errors is on by default.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[You can disable display_errors from php.ini or .htaccess.<br/><br/><b>php.ini</b><br/>display_errors = 'off'<br/>log_errors = 'on'<br/><br/><b>.htaccess</b><br/>php_flag  display_errors  off<br/>php_flag  log_errors  on]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /secured/phpinfo.php HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:11:35 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.3.10-1~lucid+2uwsgi2
Original-Content-Encoding: gzip
Content-Length: 45963
]]></Response>
        </TechnicalDetails>
        <CWE id="16"><![CDATA[CWE-16]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Runtime Configuration]]></Database>
            <URL><![CDATA[http://www.php.net/manual/en/errorfunc.configuration.php#ini.error-reporting]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="181" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /.idea/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/.idea]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /.idea/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:24 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 967
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="182" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /.idea/scopes/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/.idea/scopes]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /.idea/scopes/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:25 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 300
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="183" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /CVS/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/CVS]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /CVS/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:28 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 611
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="184" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /_mmServerScripts/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/_mmServerScripts]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /_mmServerScripts/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:30 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 416
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="185" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /wvstests/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/wvstests]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /wvstests/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:30 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 288
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="186" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /wvstests/pmwiki_2_1_19/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/wvstests/pmwiki_2_1_19]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /wvstests/pmwiki_2_1_19/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:31 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 310
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="187" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /wvstests/pmwiki_2_1_19/scripts/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/wvstests/pmwiki_2_1_19/scripts]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /wvstests/pmwiki_2_1_19/scripts/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:31 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 329
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="188" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /Mod_Rewrite_Shop/images/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/Mod_Rewrite_Shop/images]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Mod_Rewrite_Shop/images/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:33 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 529
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="189" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /pictures/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/pictures]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:34 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 2685
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="190" color="orange">
        <Name><![CDATA[WS_FTP log file found]]></Name>
        <ModuleName><![CDATA[Scripting (WS_FTP_log_file.script)]]></ModuleName>
        <Details><![CDATA[Pattern found: <pre wrap="virtual"><font color="blue">103.05.06 13:17 </font></pre>]]></Details>
        <Affects><![CDATA[/pictures//WS_FTP.LOG]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Validation]]></Type>
        <Impact><![CDATA[This file may expose sensitive information that may help an malicious user to prepare more advanced attacks.]]></Impact>
        <Description><![CDATA[WS_FTP is a popular FTP client. This application creates a log file named WS_FTP.LOG. This file contains sensitive
data such as file source/destination and file name, date/time of upload etc.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Remove this file from your website or change its permissions to remove access.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /pictures//WS_FTP.LOG HTTP/1.1
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 18:12:28 GMT
Content-Type: text/plain
Content-Length: 771
Last-Modified: Fri, 23 Jan 2009 10:06:53 GMT
Connection: keep-alive
ETag: &quot;497996bd-303&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[ws_ftp.log]]></Database>
            <URL><![CDATA[http://archives.neohapsis.com/archives/fulldisclosure/2004-08/0663.html]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="191" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /admin/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/admin]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /admin/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:36 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 278
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="192" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /Templates/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/Templates]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Templates/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/Templates/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 17:29:50 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 305
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="193" color="orange">
        <Name><![CDATA[Directory listing]]></Name>
        <ModuleName><![CDATA[Scripting (Directory_Listing.script)]]></ModuleName>
        <Details><![CDATA[<br/>Pattern found: <pre wrap="virtual"><font color="blue">&lt;title&gt;Index of /Connections/&lt;/title&gt;</font></pre>]]></Details>
        <Affects><![CDATA[/Connections]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[medium]]></Severity>
        <Type><![CDATA[Information]]></Type>
        <Impact><![CDATA[A user can view a list of all files from this directory possibly exposing sensitive information.]]></Impact>
        <Description><![CDATA[The web server is configured to display the list of files contained in this directory. This is not recommended because the directory may contain files that are not normally exposed through links on the web site.]]></Description>
        <DetailedInformation><![CDATA[<h2>How to disable directory listings</h2>
<ul>
<li>The easiest way to disable directory listing is to create an index file. The name of the index file depends on the web server configuration. On Apache is called index.htm, index.html. On IIS is named default.asp, default.aspx, default.htm.</li>
<li>On IIS directory listings are disabled by default.</li>
<li>For Apache you need to edit the Apache configuration file (usually named httpd.conf) or create an .htaccess file. In the configuration file you will have the definition of the directory. Something like  
<pre wrap="virtual"><code>&lt;Directory  /directoryname/subdirectory&gt;
Options Indexes FollowSymLinks
...
&lt;/Directory&gt;</code></pre>
To disable directory listing for that directory you need to remove the 'Indexes' option.
</li>
</ul>]]></DetailedInformation>
        <Recommendation><![CDATA[You should make sure the directory does not contain sensitive information or you may want to restrict directory listings from the web server configuration.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Connections/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*
]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:38 GMT
Content-Type: text/html
Connection: keep-alive
Original-Content-Encoding: gzip
Content-Length: 297
]]></Response>
        </TechnicalDetails>
        <CWE id="538"><![CDATA[CWE-538]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:P/I:N/A:N]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[Partial]]></C>
          <Cdesc><![CDATA[There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[None]]></A>
          <Adesc><![CDATA[There is no impact to the availability of the system.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References>
          <Reference>
            <Database><![CDATA[Directory Listing and Information Disclosure]]></Database>
            <URL><![CDATA[http://www.acunetix.com/blog/web-security-zone/directory-listing-information-disclosure/]]></URL>
          </Reference>
        </References>
      </ReportItem>
      <ReportItem id="194" color="blue">
        <Name><![CDATA[Slow response time]]></Name>
        <ModuleName><![CDATA[Crawler]]></ModuleName>
        <Details><![CDATA[No details are available.]]></Details>
        <Affects><![CDATA[/Flash/add.fla]]></Affects>
        <Parameter><![CDATA[]]></Parameter>
        <AOP_SourceFile><![CDATA[]]></AOP_SourceFile>
        <AOP_SourceLine>0</AOP_SourceLine>
        <AOP_Additional><![CDATA[]]></AOP_Additional>
        <IsFalsePositive><![CDATA[False]]></IsFalsePositive>
        <Severity><![CDATA[low]]></Severity>
        <Type><![CDATA[Informational]]></Type>
        <Impact><![CDATA[Possible denial of service.]]></Impact>
        <Description><![CDATA[This page had a slow response time. The response time for this page was <b>10467 ms</b> while the average response time for this site is <b>683.94 ms</b>. This type of files can be targeted in denial of service attacks. An attacker can request this page repeatedly from multiple computers until the server becomes overloaded.]]></Description>
        <DetailedInformation><![CDATA[]]></DetailedInformation>
        <Recommendation><![CDATA[Investigate if it's possible to reduce the response time for this page.]]></Recommendation>
        <TechnicalDetails>
          <Request><![CDATA[GET /Flash/add.fla HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
Referer: http://testphp.vulnweb.com/
Acunetix-Aspect: enabled
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect-Queries: aspectalerts
Host: testphp.vulnweb.com
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36
Accept: */*

]]></Request>
          <Response><![CDATA[HTTP/1.1 200 OK
Server: nginx/1.4.1
Date: Tue, 07 Oct 2014 14:56:29 GMT
Content-Type: text/plain
Content-Length: 154624
Last-Modified: Wed, 11 May 2011 10:27:45 GMT
Connection: keep-alive
ETag: &quot;4dca64a1-25c00&quot;
Accept-Ranges: bytes
]]></Response>
        </TechnicalDetails>
        <CWE id="400"><![CDATA[CWE-400]]></CWE>
        <CVEList/>
        <CVSS>
          <Descriptor><![CDATA[AV:N/AC:L/Au:N/C:N/I:N/A:P]]></Descriptor>
          <Score><![CDATA[5.0]]></Score>
          <AV><![CDATA[Network]]></AV>
          <AVdesc><![CDATA[A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access.]]></AVdesc>
          <AC><![CDATA[Low]]></AC>
          <ACdesc><![CDATA[Specialized access conditions or extenuating circumstances do not exist.]]></ACdesc>
          <Au><![CDATA[None]]></Au>
          <Audesc><![CDATA[Authentication is not required to exploit the vulnerability.]]></Audesc>
          <C><![CDATA[None]]></C>
          <Cdesc><![CDATA[There is no impact to the confidentiality of the system.]]></Cdesc>
          <I><![CDATA[None]]></I>
          <Idesc><![CDATA[There is no impact to the integrity of the system.]]></Idesc>
          <A><![CDATA[Partial]]></A>
          <Adesc><![CDATA[There is reduced performance or interruptions in resource availability.]]></Adesc>
          <E><![CDATA[]]></E>
          <Edesc><![CDATA[]]></Edesc>
          <RL><![CDATA[]]></RL>
          <RLdesc><![CDATA[]]></RLdesc>
          <RC><![CDATA[]]></RC>
          <RCdesc><![CDATA[]]></RCdesc>
        </CVSS>
        <References/>
      </ReportItem>
    </ReportItems>
  </Scan>
</ScanGroup>
